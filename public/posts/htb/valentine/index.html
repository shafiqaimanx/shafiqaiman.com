<!DOCTYPE html>
<html lang="en-gb"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HackTheBox - Valentine Writeup | SH∆FIQ ∆IM∆N</title>
<meta property="og:title" content="HackTheBox - Valentine Writeup | SH∆FIQ ∆IM∆N" />
<meta name="twitter:title" content="HackTheBox - Valentine Writeup | SH∆FIQ ∆IM∆N" />
<meta itemprop="name" content="HackTheBox - Valentine Writeup | SH∆FIQ ∆IM∆N" />
<meta name="application-name" content="HackTheBox - Valentine Writeup | SH∆FIQ ∆IM∆N" />
<meta property="og:site_name" content="SH∆FIQ ∆IM∆N" />

<meta name="description" content="Minimal Hugo blog theme with light and dark mode support">
<meta itemprop="description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta name="twitter:description" content="Minimal Hugo blog theme with light and dark mode support" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />



  <meta itemprop="image" content="http://example.com" />
  <meta property="og:image" content="http://example.com" />
  <meta name="twitter:image" content="http://example.com" />
  <meta name="twitter:image:src" content="http://example.com" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2022-11-20T00:00:00Z />
    <meta property="article:published_time" content=2022-11-20T00:00:00Z />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HackTheBox - Valentine Writeup",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2022-11-20",
        "description": "",
        "wordCount":  1090 ,
        "mainEntityOfPage": "True",
        "dateModified": "2022-11-20",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "SH∆FIQ ∆IM∆N"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.119.0">

    

    <link rel="canonical" href="http://example.com/posts/htb/valentine/">
    <link href="/style.min.b7e4bda148ee8a6b6e7d052cb6d77374a2dca955a40352c3ccf576dc5f33af2c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://example.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://example.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/search/">
                        Search
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HackTheBox - Valentine Writeup</h1>
                
                
                <div class="post-meta">
                    <time datetime="2022-11-20T00:00:00&#43;00:00" itemprop="datePublished"> 20 Nov 2022 </time>
                </div>
                
            </header>
                <details class="toc">
                    <summary><b>Table of Contents</b></summary>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#nmap">Nmap</a></li>
    <li><a href="#https-valentinehtb">Https: Valentine.htb</a>
      <ul>
        <li><a href="#gobuster">Gobuster</a></li>
        <li><a href="#https-dev">Https: /dev</a></li>
      </ul>
    </li>
    <li><a href="#foothold-cve-2014-0160">Foothold: CVE-2014-0160</a></li>
    <li><a href="#privesc-tmux-session">PrivEsc: Tmux Session</a></li>
  </ul>
</nav>
                </details>
                <div class="page-content">
                <h2 id="nmap">Nmap</h2>
<p>Like always, I’m going to scan the IP Address by using <a href="https://nmap.org/">nmap</a> but I’m going to scan the full port first. Then, I’m going to scan the only open ports.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p22</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">443</span><span class="w"> </span><span class="o">-</span><span class="n">sCV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">valentine</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">79</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w">  </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">      </span><span class="n">OpenSSH</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">9</span><span class="n">p1</span><span class="w"> </span><span class="n">Debian</span><span class="w"> </span><span class="mi">5</span><span class="n">ubuntu1</span><span class="p">.</span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">1024</span><span class="w"> </span><span class="mi">964</span><span class="n">c51423cba2249204d3eec90ccfd0e</span><span class="w"> </span><span class="p">(</span><span class="n">DSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">2048</span><span class="w"> </span><span class="mi">46</span><span class="n">bf1fcc924f1da042b3d216a8583133</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="mi">256</span><span class="w"> </span><span class="n">e62b2519cb7e54cb0ab9ac1698c67da9</span><span class="w"> </span><span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w">  </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">     </span><span class="n">Apache</span><span class="w"> </span><span class="n">httpd</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">22</span><span class="w"> </span><span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">22</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Site</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t have a title (text/html).
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">443/tcp open  ssl/http Apache httpd 2.2.22 ((Ubuntu))
</span></span></span><span class="line"><span class="cl"><span class="s1">| ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US
</span></span></span><span class="line"><span class="cl"><span class="s1">| Not valid before: 2018-02-06T00:45:25
</span></span></span><span class="line"><span class="cl"><span class="s1">|_Not valid after:  2019-02-06T00:45:25
</span></span></span><span class="line"><span class="cl"><span class="s1">|_ssl-date: 2022-11-16T22:23:45+00:00; +1s from scanner time.
</span></span></span><span class="line"><span class="cl"><span class="s1">|_http-server-header: Apache/2.2.22 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="s1">|_http-title: Site doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="p">(</span><span class="nb">text</span><span class="o">/</span><span class="n">html</span><span class="p">).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w"> </span><span class="n">OS</span><span class="p">:</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">CPE</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span><span class="w">
</span></span></span></code></pre></div><p>The nmap scan result is completed. There are just <code>3</code> port opens which are <code>SSH, HTTP, and HTTPS</code>. Based on the <a href="https://launchpad.net/ubuntu/+source/openssh/1:5.9p1-5ubuntu1.10">OpenSSH</a> service banner, this is an Ubuntu (precise) machine. However, on port <code>443</code>, the nmap found the <code>hostname</code> on the <code>ssl-cert</code> scripts scan. The hostname called <code>valentine.htb</code> and with that information I&rsquo;m going to add the name to the <code>/etc/hosts</code> file.</p>
<p><img src="adding-the-hostname-in-etc-hosts-file.png" alt="adding the hostname"></p>
<h2 id="https-valentinehtb">Https: Valentine.htb</h2>
<p>I navigate to port <code>443</code> on my browser and accept the <code>SSL</code> certificates. I&rsquo;ll check the certificate and nothing useful for me except the <code>hostname</code> which nmap already found it. Shockingly, the homepage it&rsquo;s just an image of a woman that looks like screaming at something. The &ldquo;Something&rdquo; is an image/logo that is related to the <code>heartbleed</code> vulnerability.</p>
<p><img src="omg-home-page.png" alt="omg homepage"></p>
<p>Then, I&rsquo;m running the second nmap scan with the <code>--script</code> flag and followed with <code>ssl-heartbleed</code> scripts.</p>
<p><img src="nmap-scan-heartbleed-scripts.png" alt="heartbleed nmap scan"></p>
<p>The result came back with <code>&quot;VULNERABLE&quot;</code> to this type of vulnerability. <a href="https://heartbleed.com/">Heartbleed</a> is a bug found in the popular OpenSSL cryptographic software library also the CVE assigned to it, called <a href="https://nvd.nist.gov/vuln/detail/cve-2014-0160">CVE-2014-0160</a>, and here&rsquo;s a <a href="https://xkcd.com/1354/">great comic</a> explaining it.</p>
<h3 id="gobuster">Gobuster</h3>
<p>Although, I know this web server is vulnerable, based on the nmap scan result above. The homepage itself also gave me a clue and based on the index file extension it&rsquo;s a <code>PHP</code> page. Then, I&rsquo;m going to run the <a href="https://github.com/OJ/gobuster">gobuster</a> to search for what&rsquo;s hidden inside this webserver with the <code>-x</code> flag for the <code>PHP</code> extension.</p>
<p><img src="gobuster-scan-result.png" alt="gobuster scan result"></p>
<h3 id="https-dev">Https: /dev</h3>
<p>The <code>/dev</code> directory caught my attention because it&rsquo;s on top of course :). Interestingly enough, this directory enables file indexing and shows there are <code>2</code> files on it. The first one is called <code>hype_key</code> and the second one is called <code>notes.txt</code>.</p>
<p><img src="dev-file-indexing-enable.png" alt="file indexing in dev"></p>
<p>However, I&rsquo;m more hype about the <code>hype_key</code> file because it sounds interesting but when I clicked it open, it&rsquo;s a bunch of <code>hex</code> bytes. So, I&rsquo;m going ahead to the best <a href="https://gchq.github.io/CyberChef/">chef</a> I know in the entire world and try to ask him about it, and BOOM! Turns out, it&rsquo;s a legit key and I&rsquo;m going to copy and save it on my machine. Based on the key itself, I assumed this is an <code>SSH</code> private key, and it&rsquo;s also <code>encrypted</code>. Now, I need to find the passphrase for it.</p>
<p><img src="cyberchef-decode-hex-bytes.png" alt="cyberchef decode hex"></p>
<h2 id="foothold-cve-2014-0160">Foothold: CVE-2014-0160</h2>
<p>Based on this <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-0160">CVE</a> which is a heartbleed vulnerability. The description says <code>&quot;which allows remote attackers to obtain sensitive information from process memory such as private key&quot;</code>. To be honest, I hope I manage to find the passphrase for the private key that I found earlier in the <code>/dev</code> directory. Like always, I&rsquo;ll search for the exploit on the <code>searchsploit</code> database and manage to find the python exploit.</p>
<p><img src="searchsploit-search-heartbleed.png" alt="searchsploit heartbleed"></p>
<p>Then, I&rsquo;m running the exploit and give the victim <code>IP</code> as an argument and the output is massive. However, it&rsquo;s a bunch of zero hex bytes of nothing and I&rsquo;ll try to chop some of it by piping the output to the <code>grep</code> command. My first time running it, and I can&rsquo;t find anything useful. So, I&rsquo;ll try to keep running it, and finally, I manage to find a <code>base64</code> string under the <code>/decode.php</code> file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; python2 32764.py 10.10.10.79 <span class="p">|</span> grep -v <span class="s2">&#34;00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00&#34;</span>
</span></span><span class="line"><span class="cl">Trying SSL 3.0...
</span></span><span class="line"><span class="cl">Connecting...
</span></span><span class="line"><span class="cl">Sending Client Hello...
</span></span><span class="line"><span class="cl">---<span class="o">[</span>snip<span class="o">]</span>---
</span></span><span class="line"><span class="cl">Received heartbeat response:
</span></span><span class="line"><span class="cl">---<span class="o">[</span>snip<span class="o">]</span>---
</span></span><span class="line"><span class="cl">  00e0: <span class="m">31</span> 2F <span class="m">64</span> <span class="m">65</span> <span class="m">63</span> 6F <span class="m">64</span> <span class="m">65</span> 2E <span class="m">70</span> <span class="m">68</span> <span class="m">70</span> 0D 0A <span class="m">43</span> 6F  1/decode.php..Co
</span></span><span class="line"><span class="cl">  00f0: 6E <span class="m">74</span> <span class="m">65</span> 6E <span class="m">74</span> 2D <span class="m">54</span> <span class="m">79</span> <span class="m">70</span> <span class="m">65</span> 3A <span class="m">20</span> <span class="m">61</span> <span class="m">70</span> <span class="m">70</span> 6C  ntent-Type: appl
</span></span><span class="line"><span class="cl">  0100: <span class="m">69</span> <span class="m">63</span> <span class="m">61</span> <span class="m">74</span> <span class="m">69</span> 6F 6E 2F <span class="m">78</span> 2D <span class="m">77</span> <span class="m">77</span> <span class="m">77</span> 2D <span class="m">66</span> 6F  ication/x-www-fo
</span></span><span class="line"><span class="cl">  0110: <span class="m">72</span> 6D 2D <span class="m">75</span> <span class="m">72</span> 6C <span class="m">65</span> 6E <span class="m">63</span> 6F <span class="m">64</span> <span class="m">65</span> <span class="m">64</span> 0D 0A <span class="m">43</span>  rm-urlencoded..C
</span></span><span class="line"><span class="cl">  0120: 6F 6E <span class="m">74</span> <span class="m">65</span> 6E <span class="m">74</span> 2D 4C <span class="m">65</span> 6E <span class="m">67</span> <span class="m">74</span> <span class="m">68</span> 3A <span class="m">20</span> <span class="m">34</span>  ontent-Length: <span class="m">4</span>
</span></span><span class="line"><span class="cl">  0130: <span class="m">32</span> 0D 0A 0D 0A <span class="m">24</span> <span class="m">74</span> <span class="m">65</span> <span class="m">78</span> <span class="m">74</span> 3D <span class="m">61</span> <span class="m">47</span> <span class="m">56</span> <span class="m">68</span> <span class="m">63</span>  2....<span class="nv">$text</span><span class="o">=</span>aGVhc
</span></span><span class="line"><span class="cl">  0140: <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span>  xxxxxxxxxxxxxxxx
</span></span><span class="line"><span class="cl">  0150: <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> <span class="m">78</span> 3d 3d 7e  <span class="nv">xxxxxxxxxxxxx</span><span class="o">==</span>~
</span></span><span class="line"><span class="cl">  0160: FA 6E <span class="m">07</span> CE <span class="m">08</span> F3 DE D1 <span class="m">69</span> D9 <span class="m">18</span> <span class="m">87</span> D5 <span class="m">31</span> <span class="m">66</span> EC  .n......i....1f.
</span></span><span class="line"><span class="cl">  0170: 6B E8 4E 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C  k.N.............
</span></span></code></pre></div><p>Looks like, someone used the <code>/decode.php</code> on this webserver to decode this string before. I navigated to the <code>/decode.php</code> page and try to decode it and it managed to encode. The encoded string is human readable and I believe it&rsquo;s a passphrase for the private key.</p>
<p><img src="decode-base64.png" alt="decode base64"></p>
<p>With this information that I gather, I&rsquo;ll try to <code>SSH</code> into the machine using the private key and <code>hype</code> as the user. Based on, the name of the key file that I found earlier, first I need to change the permission of the key with this command <code>chmod 600 &lt;file.key&gt;</code>.
However, I&rsquo;ve got an error that says <code>&quot;sign_and_send_pubkey: no mutual signature supported&quot;</code>, with quick googling I manage to find the <a href="https://transang.me/ssh-handshake-is-rejected-with-no-mutual-signature-algorithm-error/">answer</a> for it. Then, I&rsquo;ll try again to login in and KACHOW!</p>
<p><img src="hype-user.png" alt="hype user"></p>
<h2 id="privesc-tmux-session">PrivEsc: Tmux Session</h2>
<p>I&rsquo;m in as the <code>hype</code> user and the first thing I love to do is check the sudo permission with the <code>sudo -l</code> command. Unfortunately, it does require a password which I don&rsquo;t have. Then, I&rsquo;ll try to list all files in the <code>/home/hype</code> directory and I&rsquo;m amazed that the <code>.bash_history</code> file contains something. Most of the time, this file always redirects to the <code>2&gt;/dev/null</code> which is nothing.</p>
<p><img src="history.png" alt="bash history file"></p>
<p>A lot of history contains something to do with <code>Tmux</code>. So, I&rsquo;ll try to do a bunch of it and I manage to get root by executing this command <code>tmux -S /.devs/dev_sess</code> and it throws me in a <code>Tmux</code> session.</p>
<p><img src="root-user.png" alt="root user"></p>
<p>ROOT!</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/hugo-sid" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2023 shafiqaiman.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="http://example.com/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
