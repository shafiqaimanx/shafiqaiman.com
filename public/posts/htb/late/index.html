<!DOCTYPE html>
<html lang="en-gb"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HackTheBox - Late Writeup | SH∆FIQ ∆IM∆N</title>
<meta property="og:title" content="HackTheBox - Late Writeup | SH∆FIQ ∆IM∆N" />
<meta name="twitter:title" content="HackTheBox - Late Writeup | SH∆FIQ ∆IM∆N" />
<meta itemprop="name" content="HackTheBox - Late Writeup | SH∆FIQ ∆IM∆N" />
<meta name="application-name" content="HackTheBox - Late Writeup | SH∆FIQ ∆IM∆N" />
<meta property="og:site_name" content="SH∆FIQ ∆IM∆N" />

<meta name="description" content="Minimal Hugo blog theme with light and dark mode support">
<meta itemprop="description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta name="twitter:description" content="Minimal Hugo blog theme with light and dark mode support" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />



  <meta itemprop="image" content="http://example.com" />
  <meta property="og:image" content="http://example.com" />
  <meta name="twitter:image" content="http://example.com" />
  <meta name="twitter:image:src" content="http://example.com" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2022-07-30T00:00:00Z />
    <meta property="article:published_time" content=2022-07-30T00:00:00Z />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HackTheBox - Late Writeup",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2022-07-30",
        "description": "",
        "wordCount":  986 ,
        "mainEntityOfPage": "True",
        "dateModified": "2022-07-30",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "SH∆FIQ ∆IM∆N"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.119.0">

    

    <link rel="canonical" href="http://example.com/posts/htb/late/">
    <link href="/style.min.b7e4bda148ee8a6b6e7d052cb6d77374a2dca955a40352c3ccf576dc5f33af2c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://example.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://example.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/search/">
                        Search
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HackTheBox - Late Writeup</h1>
                
                
                <div class="post-meta">
                    <time datetime="2022-07-30T00:00:00&#43;00:00" itemprop="datePublished"> 30 Jul 2022 </time>
                </div>
                
            </header>
                <details class="toc">
                    <summary><b>Table of Contents</b></summary>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#nmap">Nmap</a>
      <ul>
        <li><a href="#http-latehtb">Http: late.htb</a></li>
        <li><a href="#http-imageslatehtb">Http: images.late.htb</a></li>
        <li><a href="#ssti-server-side-template-injection">SSTI (Server Side Template Injection)</a></li>
      </ul>
    </li>
    <li><a href="#ssh-svc_acc">SSH: svc_acc</a>
      <ul>
        <li><a href="#peass-ng-linpeassh">PEASS-ng: linpeas.sh</a></li>
        <li><a href="#usrlocalsbin-ssh-alertsh">/usr/local/sbin: ssh-alert.sh</a></li>
        <li><a href="#pspy">Pspy</a></li>
      </ul>
    </li>
    <li><a href="#linux-privilege-escalation">Linux: Privilege Escalation</a></li>
  </ul>
</nav>
                </details>
                <div class="page-content">
                <h2 id="nmap">Nmap</h2>
<p>Like always, I&rsquo;m going to scan the IP Address by using <a href="https://nmap.org/">Nmap</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">92</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">initiated</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="n">May</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">20</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="k">as</span><span class="p">:</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">late_all</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">156</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Nmap</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">156</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">echo</span><span class="o">-</span><span class="n">reply</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="mi">63</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">070</span><span class="n">s</span><span class="w"> </span><span class="n">latency</span><span class="p">).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Scanned</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mi">2022</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">17</span><span class="w"> </span><span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">21</span><span class="w"> </span><span class="o">+</span><span class="mi">08</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">243</span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">65533</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="p">(</span><span class="k">reset</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PORT</span><span class="w">   </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w"> </span><span class="n">REASON</span><span class="w">         </span><span class="k">VERSION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">     </span><span class="n">syn</span><span class="o">-</span><span class="n">ack</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="mi">63</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">6</span><span class="n">p1</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mi">4</span><span class="n">ubuntu0</span><span class="p">.</span><span class="mi">6</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">2048</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">0</span><span class="n">e</span><span class="p">:</span><span class="n">a3</span><span class="p">:</span><span class="n">af</span><span class="p">:</span><span class="mi">4</span><span class="n">e</span><span class="p">:</span><span class="mi">72</span><span class="p">:</span><span class="mi">9</span><span class="n">d</span><span class="p">:</span><span class="n">a4</span><span class="p">:</span><span class="n">fe</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="n">cb</span><span class="p">:</span><span class="mi">5</span><span class="n">d</span><span class="p">:</span><span class="mi">83</span><span class="p">:</span><span class="mi">07</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span><span class="w"> </span><span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABAQDSqIcUZeMzG</span><span class="o">+</span><span class="n">QAl</span><span class="o">/</span><span class="mi">4</span><span class="n">uYzsU98davIPkVzDmzTPOmMONUsYleBjGVwAyLHsZHhgsJqM9lmxXkb8hT4ZTTa1azg4JsLwX1xKa8m</span><span class="o">+</span><span class="n">RnXwJ1DibEMNAO0vzaEBMsOOhFRwm5IcoDR0gOONsYYfz18pafMpaocitjw8mURa</span><span class="o">+</span><span class="n">YeY21EpF6cKSOCjkVWa6yB</span><span class="o">+</span><span class="n">GT8mOcTZOZStRXYosrOqz5w7hG</span><span class="o">+</span><span class="mi">20</span><span class="n">RY8OYwBXJ2Ags6HJz3sqsyT80FMoHeGAUmu</span><span class="o">+</span><span class="n">LUJnyrW5foozKgxXhyOPszMvqosbrcrsG3ic3yhjSYKWCJO</span><span class="o">/</span><span class="n">Oxc76WUdUAlcGxbtD9U5jL</span><span class="o">+</span><span class="n">LY2ZCOPva1</span><span class="o">+/</span><span class="n">kznK8FhQN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="mi">41</span><span class="p">:</span><span class="n">e1</span><span class="p">:</span><span class="n">fe</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="n">a5</span><span class="p">:</span><span class="n">c7</span><span class="p">:</span><span class="mi">97</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="n">f3</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">0</span><span class="k">c</span><span class="p">:</span><span class="n">e9</span><span class="p">:</span><span class="n">fb</span><span class="w"> </span><span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span><span class="w"> </span><span class="n">AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBMen7Mjv8J63UQbISZ3Yju</span><span class="o">+</span><span class="n">a8dgXFwVLgKeTxgRc7W</span><span class="o">+</span><span class="n">k33OZaOqWBctKs8hIbaOehzMRsU7ugP6zIvYb25Kylw</span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="mi">28</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">98</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">1</span><span class="n">e</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">1</span><span class="n">a</span><span class="p">:</span><span class="mi">1</span><span class="n">e</span><span class="p">:</span><span class="n">a1</span><span class="p">:</span><span class="n">ab</span><span class="p">:</span><span class="mi">3</span><span class="n">b</span><span class="p">:</span><span class="mi">9</span><span class="n">a</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">70</span><span class="p">:</span><span class="mi">48</span><span class="w"> </span><span class="p">(</span><span class="n">ED25519</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_ssh</span><span class="o">-</span><span class="n">ed25519</span><span class="w"> </span><span class="n">AAAAC3NzaC1lZDI1NTE5AAAAIIGrWbMoMH87K09rDrkUvPUJ</span><span class="o">/</span><span class="n">ZpNAwHiUB66a</span><span class="o">/</span><span class="n">FKHWrj</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">    </span><span class="n">syn</span><span class="o">-</span><span class="n">ack</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="mi">63</span><span class="w"> </span><span class="n">nginx</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Late</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Best</span><span class="w"> </span><span class="n">online</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="n">tools</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">favicon</span><span class="p">:</span><span class="w"> </span><span class="k">Unknown</span><span class="w"> </span><span class="n">favicon</span><span class="w"> </span><span class="n">MD5</span><span class="p">:</span><span class="w"> </span><span class="mi">1575</span><span class="n">FDF0E164C3DB0739CF05D9315BDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">methods</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="n">Supported</span><span class="w"> </span><span class="n">Methods</span><span class="p">:</span><span class="w"> </span><span class="k">GET</span><span class="w"> </span><span class="n">HEAD</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">nginx</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w"> </span><span class="n">OS</span><span class="p">:</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">CPE</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Read</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">from</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">nmap</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">detection</span><span class="w"> </span><span class="n">performed</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">any</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="n">May</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="mi">23</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">24</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="c1">-- 1 IP address (1 host up) scanned in 243.26 seconds
</span></span></span></code></pre></div><p>There are only <code>2</code> ports open. The <code>22/SSH</code> and <code>80/HTTP</code> ports.</p>
<h3 id="http-latehtb">Http: late.htb</h3>
<p>Well, the <code>SSH</code> is open. However, I&rsquo;m going to ignore it because that&rsquo;s almost not likely going to be vulnerable. So, I&rsquo;m going to check the other port, which is <code>port 80</code> by navigating through my browser. That&rsquo;s unexpected, I found a subdomain called <code>images</code> and also the hostname <code>late.htb</code>. I&rsquo;m going to add it to my <code>/etc/hosts</code> file.</p>
<p><img src="late-htb-main-page.png" alt="1"></p>
<p><img src="add-the-hostname-into-file.png" alt="1"></p>
<h3 id="http-imageslatehtb">Http: images.late.htb</h3>
<p>Going to the <code>images.late.htb</code> it says <code>convert image to text with flask</code>. Well, I&rsquo;m using  <a href="https://www.kali.org/">kali</a> linux and its came with <code>mousepad</code> as text editor (<a href="https://www.xfce.org/">XFCE</a> flavour). So, I&rsquo;m going to open the text editor and type the <code>Hello,World</code> as the text and screenshot it with <a href="https://flameshot.org/">Flameshot</a>. Save it and upload the file.</p>
<p><img src="images-late-htb-main-page.png" alt="1"></p>
<p>After I uploaded it, my browser downloaded the file called <code>result.txt</code>. When I read the content of the file it says <code>Hello,World</code> like the image that I uploaded but it&rsquo;s wrapped in an HTML paragraph tag.</p>
<p><img src="hello-world-output-result-txt.png" alt="1"></p>
<h3 id="ssti-server-side-template-injection">SSTI (Server Side Template Injection)</h3>
<p>That&rsquo;s interesting. So, like any human being that I am. I asked for help from Mr.Google itself (ask nicely of course;p). I&rsquo;ve got bombarded with the result always something to do with <a href="https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection">SSTI</a>. Well, to be fair! this is a <a href="https://flask.palletsprojects.com/en/2.1.x/">flask</a> application that&rsquo;s using <a href="https://jinja.palletsprojects.com/en/3.1.x/">jinja</a> as the template engine. It does make sense if this app is vulnerable to it.</p>
<p>Time to find out! first, I&rsquo;m going to upload an image with this payload as text <em>{{7*7}}</em>. In theory, the template engine will see this as a mathematical equation and try to solve it. Hold and behold, the result is <code>49</code> and this is a positive indication it is vulnerable. So, I&rsquo;ll try uploading the <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinja2---read-remote-file">read file payload</a>. In this case, it is <code>/etc/passwd</code> file. It successfully retrieves the file.</p>
<p><em>NOTE: I&rsquo;m using Roboto Slab Regular fonts in Mousepad</em></p>
<p><img src="read-file-etc-password-payload-ssti.png" alt="1"></p>
<p><img src="read-file-etc-passwd.png" alt="1"></p>
<h2 id="ssh-svc_acc">SSH: svc_acc</h2>
<p>From the result above, there are just two users in this box. The <code>root</code> and <code>svc_acc</code> user. Also, the nmap scan result above shows <code>port 22</code> is open. Which is <code>SSH</code>. Then, I&rsquo;ll try to retrieve the <code>svc_acc</code> ssh private key in the user&rsquo;s home directory in the <code>.ssh</code></p>
<p><img src="grep-the-user-from-etc-passwd.png" alt="1"></p>
<p>I&rsquo;ll change the payload from read <code>/etc/passwd</code> file into <code>/home/svc_acc/.ssh/id_rsa</code>. Well, the result came back and it did not disappoint at all. So, I&rsquo;m going to open the file and remove the HTML paragraph tag <code>&lt;p&gt;&lt;/p&gt;</code>, and save it into a new name called <code>svc_acc</code>. Also, change the permission with this command; <code>chmod 600 &lt;id_rsa&gt;</code>. Without further ado, I&rsquo;m going to ssh into the box with this key. (please work *finger cross*). It did work! YES!</p>
<p><img src="read-ssh-file-with-ssti-payload.png" alt="1"></p>
<p><img src="ssh-in-the-box-as-svc_acc.png" alt="1"></p>
<h3 id="peass-ng-linpeassh">PEASS-ng: linpeas.sh</h3>
<p>I&rsquo;m in as a <code>svc_acc</code> user and I also can read the first flag, which is the <code>user flag</code>. To be honest, I just want a quick win. Since this is a linux box, I&rsquo;m going to run the linpeas script in this box. As always, I&rsquo;m going to run the latest version of <a href="https://github.com/carlospolop/PEASS-ng">linpeas</a> from <a href="https://twitter.com/carlospolopm">carlospolop</a>.</p>
<p>After it is all done running, I&rsquo;ll check the output and find something weird. A directory called <code>/usr/local/sbin</code> contain a file called <code>ssh-alert.sh</code>. The file itself looks like a <code>bash script</code> because it&rsquo;s ended up with <code>.sh</code> extensions and this file is not a native to the linux ecosystem. (I think?)</p>
<p><img src="linpeas-find-the-ssh-alert-file.png" alt="1"></p>
<h3 id="usrlocalsbin-ssh-alertsh">/usr/local/sbin: ssh-alert.sh</h3>
<p>Upon inspecting the file, it&rsquo;s looks like this file probably running every time someone logs in. Well, I&rsquo;ll try to edit the file but permissions don&rsquo;t allow me to write it when I checked the file attribute. Turns out, I can append something to this file.</p>
<p>However, if I manage to change this file. It doesn&rsquo;t mean I&rsquo;m going to be <code>root</code> because this file belongs to the <code>svc_acc</code> user &amp; groups. Honestly, I&rsquo;m stuck and don&rsquo;t know what to do next. So, I reached out to the <a href="https://discord.com/invite/hackthebox">HackTheBOX community</a> and got a nudge on <code>pspy</code>. I&rsquo;m super excited because I&rsquo;ve never used this tool before let alone known it exists.</p>
<p><img src="ssh-alert-read-pic.png" alt="1"></p>
<h3 id="pspy">Pspy</h3>
<p><a href="https://github.com/DominicBreuker/pspy">Pspy</a> is a command-line tool designed to snoop on processes without the need for root permissions. It allows seeing commands run by other users, cron jobs, etc. as they execute. Without wasting any single second, I&rsquo;m going to download the <code>pspy64</code> on the release page and execute it.</p>
<p><img src="run-the-pspy.png" alt="1"></p>
<p>Based on the file <code>ssh-alert.sh</code> above. I need to make an ssh connection, to be able to execute the file. So, I&rsquo;m going to open a new terminal and ssh in the box again. Interestingly, something pops out in the pspy output. The output itself shows the <code>ssh-alert.sh</code> file be executed by <code>root</code> and I can gain the <code>reverse shell</code> in this way.</p>
<p><em>NOTE: UID=0 is root</em></p>
<p><img src="ssh-in-the-box-once-again.png" alt="1"></p>
<h2 id="linux-privilege-escalation">Linux: Privilege Escalation</h2>
<p>Going back to the <code>/usr/local/sbin</code> directory, I&rsquo;m going to append the bash <code>reverse shell</code> into the <code>ssh-alert.sh</code> file. As mentioned above, I&rsquo;m going to make a connection once again, and BOOM!. I&rsquo;ve got the root shell.</p>
<p><img src="append-the-reverse-shell.png" alt="1"></p>
<p><img src="root-shell.png" alt="1"></p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/hugo-sid" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2023 shafiqaiman.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="http://example.com/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
