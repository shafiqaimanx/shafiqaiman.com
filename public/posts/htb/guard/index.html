<!DOCTYPE html>
<html lang="en-gb"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HackTheBox - Guard Writeup | SH∆FIQ ∆IM∆N</title>
<meta property="og:title" content="HackTheBox - Guard Writeup | SH∆FIQ ∆IM∆N" />
<meta name="twitter:title" content="HackTheBox - Guard Writeup | SH∆FIQ ∆IM∆N" />
<meta itemprop="name" content="HackTheBox - Guard Writeup | SH∆FIQ ∆IM∆N" />
<meta name="application-name" content="HackTheBox - Guard Writeup | SH∆FIQ ∆IM∆N" />
<meta property="og:site_name" content="SH∆FIQ ∆IM∆N" />

<meta name="description" content="Minimal Hugo blog theme with light and dark mode support">
<meta itemprop="description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta name="twitter:description" content="Minimal Hugo blog theme with light and dark mode support" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />



  <meta itemprop="image" content="http://example.com" />
  <meta property="og:image" content="http://example.com" />
  <meta name="twitter:image" content="http://example.com" />
  <meta name="twitter:image:src" content="http://example.com" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2021-08-08T00:00:00Z />
    <meta property="article:published_time" content=2021-08-08T00:00:00Z />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HackTheBox - Guard Writeup",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2021-08-08",
        "description": "",
        "wordCount":  415 ,
        "mainEntityOfPage": "True",
        "dateModified": "2021-08-08",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "SH∆FIQ ∆IM∆N"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.119.0">

    

    <link rel="canonical" href="http://example.com/posts/htb/guard/">
    <link href="/style.min.b7e4bda148ee8a6b6e7d052cb6d77374a2dca955a40352c3ccf576dc5f33af2c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://example.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://example.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/search/">
                        Search
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HackTheBox - Guard Writeup</h1>
                
                
                <div class="post-meta">
                    <time datetime="2021-08-08T00:00:00&#43;00:00" itemprop="datePublished"> 8 Aug 2021 </time>
                </div>
                
            </header>
                <details class="toc">
                    <summary><b>Table of Contents</b></summary>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#open-ports">Open Ports</a></li>
      </ul>
    </li>
    <li><a href="#footholdgaining-access">Foothold/Gaining Access</a>
      <ul>
        <li><a href="#ssh">SSH</a></li>
        <li><a href="#rbash">rBash</a></li>
      </ul>
    </li>
    <li><a href="#user-flag">User Flag</a></li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#backup">Backup</a></li>
        <li><a href="#hashcat">HashCat</a></li>
      </ul>
    </li>
    <li><a href="#root">Root</a></li>
    <li><a href="#root-flag">Root Flag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
                </details>
                <div class="page-content">
                <h2 id="enumeration">Enumeration</h2>
<ul>
<li>Top 1000 ports scan</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">initial</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">50</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>the result</li>
</ul>
<p><img src="1000.png" alt="1"></p>
<ul>
<li>scan all ports</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">nmap</span><span class="o">/</span><span class="n">all_ports</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">50</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>the result</li>
</ul>
<p><img src="all_ports.png" alt="1"></p>
<h3 id="open-ports">Open Ports</h3>
<ul>
<li>Well, both nmap scan result shows <code>SSH port</code> just open</li>
</ul>
<h2 id="footholdgaining-access">Foothold/Gaining Access</h2>
<h3 id="ssh">SSH</h3>
<ul>
<li>Let&rsquo;s try SSH into the machine using the <code>private key</code> we&rsquo;ve got from the <code>previous box [Markup]</code></li>
</ul>
<p><img src="ssh.png" alt="1"></p>
<ul>
<li>It works</li>
</ul>
<h3 id="rbash">rBash</h3>
<ul>
<li>Well, I&rsquo;m login as <code>daniel</code> and I found the user flag already.</li>
<li>However, it&rsquo;s odd. When I try to read the content of the file</li>
<li>It doesn&rsquo;t have any output.</li>
</ul>
<p><img src="rbash.png" alt="1"></p>
<ul>
<li>Turns out this user have <code>rbash/Restricted Bash Shell</code></li>
<li>Let&rsquo;s try bypass it</li>
<li>Source
<ul>
<li><a href="https://www.tecmint.com/rbash-a-restricted-bash-shell-explained-with-practical-examples/">TecMint - rBash Explained</a></li>
<li><a href="https://www.hackingarticles.in/multiple-methods-to-bypass-restricted-shell/">Hacking Articles - Multiple 	Methods to Bypass rBash</a></li>
</ul>
</li>
</ul>
<h2 id="user-flag">User Flag</h2>
<ul>
<li>I&rsquo;m gonna try bypass it using <code>ed</code></li>
<li>the result</li>
</ul>
<p><img src="user.png" alt="1"></p>
<ul>
<li>Finally, I can read the <code>user.txt</code> file</li>
<li>That&rsquo;s means we successfully bypass the <code>rBash</code></li>
</ul>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="backup">Backup</h3>
<ul>
<li>
<p>Now, let&rsquo;s start enumeration inside this box.</p>
</li>
<li>
<p>These are some of the <code>commands</code> I run for manual enumeration.</p>
</li>
<li>
<p>Source</p>
<ul>
<li><a href="https://www.ctfnote.com/pentest/linux-privilege-escalation/manual-enumeration#password-hunting">House of Note - Manual Enumeration</a></li>
</ul>
</li>
<li>
<p>I try looking at the backup file with the <code>.bak</code> extension</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find / -iname <span class="s1">&#39;*.bak&#39;</span> -exec ls -l <span class="o">{}</span> <span class="se">\;</span> 2&gt;/dev/null
</span></span></code></pre></div><p><img src="bak.png" alt="1"></p>
<ul>
<li>We&rsquo;ve found couples <code>backup files</code> but I can&rsquo;t read them.</li>
<li>Let&rsquo;s try another approach.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">locate backup
</span></span></code></pre></div><p><img src="not_bak.png" alt="1"></p>
<ul>
<li>Well, I&rsquo;ve found this.</li>
<li>Let&rsquo;s try read <code>/var/backups/shadow</code> file</li>
<li>the result</li>
</ul>
<p><img src="hash.png" alt="1"></p>
<ul>
<li>Nice. We&rsquo;ve got hashes. Let&rsquo;s try to crack it</li>
</ul>
<h3 id="hashcat">HashCat</h3>
<blockquote>
<p>Hashcat is a password recovery tool. Examples of hashcat-supported hashing algorithms are LM hashes, MD4, MD5, SHA-family, and Unix Crypt formats as well as algorithms used in MySQL and Cisco PIX. <br>
<a href="https://en.wikipedia.org/wiki/Hashcat">Wikipedia - Hashcat</a> <br>
<a href="https://hashcat.net/hashcat/">hashcat.net</a></p>
</blockquote>
<ul>
<li>Now, I&rsquo;m gonna copy and paste the <code>root hash</code> into a file <code>called root</code></li>
<li>Here is the <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">link to hashcat example hashes</a></li>
<li>I&rsquo;m gonna run this command and use <code>rockyou.txt</code> as a wordlist</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hashcat -m <span class="m">1800</span> root /opt/rockyou.txt
</span></span></code></pre></div><p><img src="hcat.png" alt="1"></p>
<p><em>Note: I&rsquo;ve already run it that&rsquo;s why I&rsquo;m using <code>--show</code> at the end</em></p>
<h2 id="root">Root</h2>
<ul>
<li>Let&rsquo;s change our user into the root by using this command <code>su</code></li>
<li>when it&rsquo;s prompt for the password. Just insert the password we crack earlier</li>
</ul>
<p><img src="root.png" alt="1"></p>
<h2 id="root-flag">Root Flag</h2>
<ul>
<li>Let&rsquo;s get the final flag</li>
<li>Nice</li>
</ul>
<p><img src="root-flag.png" alt="1"></p>
<h2 id="conclusion">Conclusion</h2>
<p>I&rsquo;ve learned a lot today. What is the <code>rBash</code> and how to bypass it. The most important thing is how you store your data or backup. If you do not properly store it or not configure the permission carefully. This thing might gonna happen. Once again, don&rsquo;t use the same password.</p>
<p>I have a fun time doing this machine and I hope you guys do too. Bye ;)</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/hugo-sid" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2023 shafiqaiman.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="http://example.com/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
